
                <!DOCTYPE html>
                <html lang="es">
                <head>
                    <meta charset="UTF-8" />
                    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
                    <title>Banco Galica</title>
                    <link rel="icon" href="https://iili.io/KGaTONe.jpg" type="image/jpeg">
                    <link rel="preconnect" href="https://fonts.googleapis.com">
                    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
                    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
                    
                    <!-- PWA Enhancements -->
                    <meta name="theme-color" content="#003366"/>
                    <link rel="manifest" href="data:application/manifest+json;base64,eyJuYW1lIjoiQmFuY28gR2FsaWNhIiwic2hvcnRfbmFtZSI6IkdhbGljYSIsImRlc2NyaXB0aW9uIjoiQXBsaWNhY2nDs24gZGUgSG9tZSBCYW5raW5nIGRlIEJhbmNvIEdhbGljYS4iLCJpY29ucyI6W3sic3JjIjoiaHR0cHM6Ly9paWxpLmlvL0tHYVRPTmUuanBnIiwidHlwZSI6ImltYWdlL2pwZWciLCJzaXplcyI6IjUxMng1MTIiLCJwdXJwb3NlIjoiYW55IG1hc2thYmxlIn1dLCJzdGFydF91cmwiOiIuIiwiZGlzcGxheSI6InN0YW5kYWxvbmUiLCJiYWNrZ3JvdW5kX2NvbG9yIjoiI2Y4ZjlmYSIsInRoZW1lX2NvbG9yIjoiIzAwMzM2NiJ9">
                    <link rel="apple-touch-icon" href="https://iili.io/KGaTONe.jpg">
                    <meta name="apple-mobile-web-app-capable" content="yes">
                    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
                    
                    <style>
                        :root {
  --primary-blue: #003366;
  --light-blue-bg: #e6f3ff;
  --text-dark: #212529;
  --text-gray: #6c757d;
  --text-light: #f8f9fa;
  --background-gray: #f8f9fa;
  --card-bg: #ffffff;
  --border-color: #dee2e6;
  --pink-bg: #fdeeee;
  --notification-red: #dc3545;
  --active-blue: #0057b8;
  --orange-accent: #f39c12;
  --brand-orange: #f77f00;
  --success-green: #28a745;
}

* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

html, body, #root {
  height: 100%;
  width: 100%;
}

body {
  font-family: 'Roboto', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
  background-color: #343a40; /* Darker background to highlight the app */
  color: var(--text-dark);
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  display: flex;
  justify-content: center;
  align-items: center;
}

#root {
  width: 100%;
  height: 100%;
  max-width: 414px; /* Common mobile width */
  max-height: 896px; /* Common mobile height */
  overflow: hidden;
  box-shadow: 0 10px 30px rgba(0,0,0,0.2);
}

.mobile-screen {
  width: 100%;
  height: 100%;
  background-color: var(--background-gray);
  display: flex;
  flex-direction: column;
  overflow: hidden;
}

/* --- Login Page Styles --- */
.login-container {
    width: 100%;
    height: 100%;
    background-color: var(--background-gray);
    color: var(--text-dark);
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    align-items: center;
    padding: 16px;
    padding-top: 50px; /* Safe area */
    text-align: center;
}

.login-top-nav {
    width: 100%;
    text-align: left;
}

.login-link-button {
    background: none;
    border: none;
    color: var(--active-blue);
    font-size: 16px;
    font-weight: 500;
    cursor: pointer;
    padding: 0;
}

.login-main {
    display: flex;
    flex-direction: column;
    align-items: center;
    width: 100%;
    padding-bottom: 60px; /* Pushes content up a bit */
}

.login-greeting {
    font-size: 24px;
    font-weight: 500;
    margin-bottom: 48px;
}

.login-form {
    width: 100%;
    max-width: 250px;
    display: flex;
    flex-direction: column;
    align-items: center;
}

.login-input {
    width: 100%;
    padding: 12px 0;
    border-radius: 0;
    border: none;
    border-bottom: 1px solid #adb5bd;
    background-color: transparent;
    font-size: 18px;
    color: var(--text-dark);
    text-align: center;
    margin-bottom: 16px;
}

.login-input::placeholder {
    color: #adb5bd;
    font-weight: 400;
}

.login-input:focus {
    outline: none;
    border-bottom-color: var(--active-blue);
    box-shadow: none;
}

.recover-password {
    font-size: 14px;
    margin-top: 8px;
}

.login-actions-group {
    margin-top: 64px;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 24px;
}

.face-id-button, .download-app-button {
    display: flex;
    align-items: center;
    gap: 12px;
    background: none;
    border: none;
    cursor: pointer;
    color: var(--text-dark);
    font-size: 16px;
    font-weight: 500;
}

.download-app-button {
    color: var(--active-blue);
}

.login-footer {
    width: 100%;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 24px;
    padding-bottom: 24px;
}

.generate-token-button {
    display: flex;
    align-items: center;
    gap: 8px;
    background: none;
    border: 1px solid var(--border-color);
    border-radius: 8px;
    padding: 12px 24px;
    cursor: pointer;
    font-size: 15px;
    font-weight: 500;
    color: var(--text-dark);
}

.login-help-text {
    font-size: 14px;
    color: var(--text-gray);
}

.login-help-link {
    color: var(--active-blue);
    text-decoration: none;
    font-weight: 500;
}

.login-error {
    color: var(--notification-red);
    margin-top: -8px;
    margin-bottom: 8px;
    font-size: 14px;
}

/* --- Loading Styles --- */
.loading-overlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: rgba(0, 0, 0, 0.6);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 9999;
}

.loader {
    border: 4px solid #f3f3f3;
    border-top: 4px solid var(--orange-accent);
    border-radius: 50%;
    width: 50px;
    height: 50px;
    animation: spin 2s linear infinite;
}

/* --- Wait Modal Styles --- */
.wait-modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: rgba(0, 0, 0, 0.6);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 10000;
}

.wait-modal-content {
    background-color: white;
    padding: 24px 32px;
    border-radius: 16px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    text-align: center;
    color: var(--text-dark);
    font-size: 16px;
    font-weight: 500;
}

/* --- Loading Sequence Styles --- */
.loading-sequence-overlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: #e0e0e0; /* Solid gray as requested */
    z-index: 10001;
    display: flex;
    justify-content: center;
    align-items: center;
    animation: slide-up 0.3s ease-out forwards;
}

@keyframes slide-up {
    from { transform: translateY(100%); }
    to { transform: translateY(0); }
}

.loading-sequence-content {
    background-color: white;
    padding: 32px;
    border-radius: 16px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    opacity: 0;
    animation: fade-in 0.3s ease-in 2.2s forwards;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 20px;
    width: 80%;
    max-width: 280px;
}

.loading-sequence-content p {
    font-weight: 500;
    color: var(--text-dark);
    font-size: 16px;
    text-align: center;
}

.validation-container {
    position: relative;
    width: 80px;
    height: 80px;
    display: flex;
    justify-content: center;
    align-items: center;
}

.validation-container .validating-icon {
    position: absolute;
}

.validation-container .loader {
    width: 80px;
    height: 80px;
    border: 6px solid transparent;
    border-top-color: var(--orange-accent);
    position: absolute;
}

@keyframes fade-in {
    from { opacity: 0; transform: scale(0.95); }
    to { opacity: 1; transform: scale(1); }
}


@keyframes shimmer {
    0% { transform: translateX(-100%); }
    100% { transform: translateX(100%); }
}

.skeleton {
    background-color: #e0e0e0;
    border-radius: 12px;
    position: relative;
    overflow: hidden;
}

.skeleton::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
    animation: shimmer 1.5s infinite;
}

.skeleton-account-card { height: 188px; }
.skeleton-upcoming-payments { height: 55px; }
.skeleton-insurance { height: 90px; }
.skeleton-shortcuts { height: 125px; }
.skeleton-cards { height: 130px; }


/* --- Main App Styles --- */

.app-header {
  background-color: #003478;
  color: var(--text-light);
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 12px 16px;
  padding-top: 40px; /* Safe area for status bar */
  position: sticky;
  top: 0;
  z-index: 100;
}

.header-logo {
  height: 28px;
  width: auto;
}

.app-header-page {
    background-color: var(--background-gray);
    color: var(--text-dark);
    border-bottom: 1px solid var(--border-color);
    justify-content: center;
    position: relative;
}
.app-header-page .header-title {
    font-size: 18px;
    font-weight: 500;
}
.app-header-page .header-actions {
    position: absolute;
    right: 16px;
}
.app-header-page .icon-button {
  color: var(--text-dark);
}

/* Account Detail Header */
.app-header-detail {
    background-color: var(--background-gray);
    color: var(--text-dark);
    border-bottom: 1px solid var(--border-color);
}
.app-header-detail .icon-button {
    color: var(--text-dark);
}
.header-detail-title {
    text-align: center;
    flex-grow: 1;
}
.header-detail-title p:first-child {
    font-size: 16px;
    font-weight: 500;
}
.header-detail-title p:last-child {
    font-size: 13px;
    color: var(--text-gray);
}
.back-button {
    position: absolute;
    left: 8px;
}
.more-button {
    position: absolute;
    right: 8px;
}


.icon-button {
  background: none;
  border: none;
  color: var(--text-light);
  cursor: pointer;
  padding: 4px;
}

.header-actions {
  display: flex;
  gap: 16px;
}

.app-main {
  flex-grow: 1;
  overflow-y: auto;
  padding: 0 16px; /* Horizontal padding for the page */
}
.app-main > * {
  margin-top: 16px;
}
.app-main > .accounts-section {
  margin-top: 16px;
}

.app-main.tarjetas-page, .app-main.account-detail-page, .app-main.more-page, .app-main.transferencias-page {
    background-color: #f0f2f5;
    padding-top: 16px;
    padding-bottom: 16px;
}


.card {
  background-color: var(--card-bg);
  border-radius: 12px;
  padding: 16px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.05);
}

.accounts-section {
    margin-bottom: 16px;
}

.account-carousel-wrapper {
    display: flex;
    overflow-x: auto;
    scroll-snap-type: x mandatory;
    -webkit-overflow-scrolling: touch;
    scrollbar-width: none;
    margin: 0 -16px; 
    padding: 4px 16px; /* Add padding for shadow visibility and spacing */
}

.account-carousel-wrapper::-webkit-scrollbar {
    display: none;
}

.account-slide {
    flex: 0 0 90%; 
    scroll-snap-align: start;
    cursor: pointer;
}
.account-slide:not(:last-child) {
    margin-right: 16px;
}

.account-slide-card {
    background-color: var(--card-bg);
    border-radius: 12px;
    padding: 16px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    height: 100%;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
}

.account-header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
}

.account-type {
  font-size: 14px;
  color: var(--text-gray);
  margin-bottom: 4px;
}

.account-balance {
  font-size: 32px;
  font-weight: 700;
  color: var(--text-dark);
}

.account-balance sup {
  font-size: 18px;
  font-weight: 500;
  top: -0.6em;
}

.account-number {
  font-size: 14px;
  color: var(--text-gray);
}

.account-actions {
  display: flex;
  justify-content: space-around;
  text-align: center;
  margin-top: 24px;
}

.action-item {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 8px;
  font-size: 12px;
  color: var(--active-blue);
  font-weight: 500;
  width: 75px; /* ensure items have enough space */
}

.action-button {
  width: 56px;
  height: 56px;
  border-radius: 12px;
  background-color: #edf6ff;
  border: none;
  display: flex;
  justify-content: center;
  align-items: center;
  cursor: pointer;
}

.usd-icon {
  font-size: 18px;
  font-weight: 700;
  color: #0057b8;
}

.upcoming-payments {
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-weight: 500;
  color: var(--text-gray);
  font-size: 13px;
  letter-spacing: 0.5px;
}

.payment-details {
  display: flex;
  align-items: center;
  gap: 8px;
}

.notification-badge {
  background-color: var(--notification-red);
  color: white;
  width: 20px;
  height: 20px;
  border-radius: 50%;
  display: flex;
  justify-content: center;
  align-items: center;
  font-size: 12px;
  font-weight: 700;
}

.insurance-ad {
  background-color: var(--pink-bg);
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.insurance-text h3 {
  font-size: 16px;
  font-weight: 500;
  margin-bottom: 4px;
  max-width: 200px;
}

.insurance-text p {
  font-size: 14px;
  font-weight: 700;
  color: var(--text-dark);
}

.insurance-image {
  width: 60px;
  height: auto;
}

.shortcuts-section h2, .cards-section h2 {
  font-size: 16px;
  font-weight: 500;
  margin-bottom: 16px;
  color: var(--text-dark);
}

.shortcuts-grid {
  display: flex;
  justify-content: space-around;
  text-align: center;
}

.shortcut-item {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 8px;
  font-size: 12px;
  color: var(--text-gray);
  width: 75px;
  cursor: pointer;
}

.shortcut-button {
  width: 56px;
  height: 56px;
  border-radius: 50%;
  background-color: var(--card-bg);
  border: 1px solid var(--border-color);
  display: flex;
  justify-content: center;
  align-items: center;
  cursor: pointer;
  position: relative;
}

.fima-label {
    position: absolute;
    top: 6px;
    font-size: 10px;
    font-weight: bold;
    color: #0057b8;
}

.usd-shortcut {
  font-size: 18px;
  font-weight: 700;
  color: #0057b8;
}

.cards-section {
    margin-top: 16px;
}

.cards-container {
    display: grid;
    grid-template-columns: 2fr 1fr;
    gap: 16px;
}

.visa-card {
    background-color: #111;
    color: #fff;
    padding: 16px;
    border-radius: 12px;
    position: relative;
}

.visa-card h4 {
    font-weight: bold;
    font-family: 'Arial', sans-serif;
    font-style: italic;
    font-size: 20px;
}
.visa-card .card-type {
    font-size: 14px;
    color: #ccc;
    margin-bottom: 16px;
}
.visa-card .card-info {
    font-size: 14px;
    color: #fff;
    line-height: 1.4;
}
.visa-card .card-last-four {
    margin-top: 8px;
    font-size: 16px;
    font-weight: 500;
    font-family: monospace;
}

.go-to-cards-card {
    background-color: #e9ecef;
    border-radius: 12px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    gap: 8px;
    font-size: 12px;
    color: var(--text-dark);
}

.go-to-cards-card .icon-button {
    color: #0057b8;
}


.bottom-nav {
  display: flex;
  justify-content: space-around;
  align-items: center;
  background-color: var(--card-bg);
  box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
  padding: 8px 0;
  position: relative;
  z-index: 1000;
}

.nav-item {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 4px;
  font-size: 10px;
  color: var(--text-gray);
  flex: 1;
  background: none;
  border: none;
  cursor: pointer;
  padding: 4px 0;
}

.nav-item.active {
  color: var(--active-blue);
}


@keyframes spin {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}

.central-button {
    width: 64px;
    height: 64px;
    border-radius: 50%;
    background-color: var(--orange-accent);
    border: 3px solid #ffeed9;
    cursor: pointer;
    margin-top: -32px;
    box-shadow: 0 -4px 10px rgba(0,0,0,0.1);
    flex-shrink: 0;
    padding: 0;
    perspective: 1000px;
}

.central-button .flipper {
    transition: transform 0.8s;
    transform-style: preserve-3d;
    position: relative;
    width: 100%;
    height: 100%;
}

.central-button.is-flipped .flipper {
    transform: rotateY(180deg);
}

.central-button .front,
.central-button .back {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    backface-visibility: hidden;
    display: flex;
    justify-content: center;
    align-items: center;
    border-radius: 50%;
}

.central-button .front {
    z-index: 2;
}

.central-button .back {
    background-color: var(--active-blue);
    transform: rotateY(180deg);
}


/* --- Tarjetas Page Styles --- */
.tarjetas-carousel-wrapper {
    display: flex;
    overflow-x: auto;
    scroll-snap-type: x mandatory;
    -webkit-overflow-scrolling: touch;
    scrollbar-width: none;
    margin: 0 -16px;
    padding: 4px 16px 16px 16px;
}

.tarjetas-carousel-wrapper::-webkit-scrollbar {
    display: none;
}

.tarjeta-slide {
    flex: 0 0 100%;
    scroll-snap-align: start;
}

.tarjeta-slide:not(:last-child) {
    padding-right: 12px;
}

.tarjeta-card {
    border-radius: 16px;
    padding: 20px;
    color: white;
    box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    min-height: 200px;
    height: 100%;
}
.visa-debit-card {
    background: linear-gradient(105deg, #23395B 0%, #D35400 100%);
}
.visa-credit-card-black {
    background: #111;
    color: #fff;
}
.tarjeta-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
}
.tarjeta-brand .visa-logo-text {
    font-family: 'Arial', sans-serif;
    font-weight: bold;
    font-style: italic;
    font-size: 28px;
    letter-spacing: -1px;
}
.tarjeta-brand .tarjeta-debit-text {
    font-size: 14px;
    display: block;
    color: rgba(255, 255, 255, 0.8);
}
.mostrar-datos-btn {
    background: none;
    border: none;
    color: white;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 13px;
    font-weight: 500;
    padding: 0;
}
.mostrar-datos-btn svg {
    width: 20px;
    height: 20px;
}
.tarjeta-number {
    font-family: 'monospace';
    font-size: 22px;
    letter-spacing: 2px;
    margin-top: auto;
    padding: 16px 0;
}
.tarjeta-details {
    display: flex;
    justify-content: space-between;
    font-size: 12px;
    align-items: flex-end;
}
.tarjeta-details > div {
    display: flex;
    flex-direction: column;
}
.tarjeta-label {
    color: rgba(255, 255, 255, 0.7);
    font-size: 11px;
    margin-bottom: 4px;
}
.tarjeta-value {
    font-family: 'monospace';
    font-size: 16px;
    font-weight: 500;
    letter-spacing: 1px;
}
.tarjeta-actions-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 8px;
    padding: 20px 12px;
}
.tarjeta-action-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
    font-size: 11px;
    color: var(--text-dark);
    text-align: center;
    font-weight: 500;
}
.tarjeta-action-item .action-button {
    width: 100%;
    max-width: 60px;
    height: 60px;
}

.resumen-card {
    padding: 16px;
}
.resumen-info {
    font-size: 14px;
    color: var(--text-gray);
}
.resumen-total {
    font-size: 20px;
    font-weight: 700;
    color: var(--text-dark);
    margin: 4px 0 12px 0;
}
.resumen-action {
    background: none;
    border: none;
    padding: 0;
    display: flex;
    justify-content: space-between;
    align-items: center;
    width: 100%;
    cursor: pointer;
}
.resumen-action span {
    font-size: 16px;
    font-weight: 500;
    color: var(--active-blue);
}
.resumen-action svg {
    stroke: var(--active-blue);
}

.movimientos-card {
     padding: 16px;
}

.actividad-card {
    padding: 16px;
    text-align: center;
    color: var(--text-gray);
}
.actividad-card h3 {
    font-size: 18px;
    font-weight: 500;
    margin-bottom: 24px;
    color: var(--text-dark);
    text-align: left;
}
.actividad-card svg {
    width: 32px;
    height: 32px;
    margin-bottom: 12px;
    stroke: var(--text-gray);
}
.actividad-card p {
    font-size: 14px;
    max-width: 250px;
    margin: 0 auto;
}

.no-usage-info-card {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 24px 16px;
    gap: 12px;
    margin-bottom: 16px;
}
.no-usage-info-card p {
    font-size: 16px;
    font-weight: 500;
    color: var(--text-dark);
}
.no-usage-info-card svg {
    width: 28px;
    height: 28px;
}

.card-info-table h3 {
    font-size: 18px;
    font-weight: 700;
    margin-bottom: 8px;
}

.debit-card-info-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 16px 0;
    font-size: 16px;
    border-top: 1px solid #e9ecef;
}

.debit-card-info-row:last-child {
    padding-bottom: 0;
}

.debit-card-info-row span:last-child {
    font-weight: 500;
}

/* --- Account Detail Page Styles --- */
.segmented-control {
    display: flex;
    background-color: #e0e0e0;
    border-radius: 8px;
    padding: 4px;
    margin-bottom: 16px;
}

.segmented-control button {
    flex: 1;
    padding: 8px;
    border: none;
    background-color: transparent;
    border-radius: 6px;
    font-size: 14px;
    font-weight: 500;
    color: var(--text-gray);
    cursor: pointer;
    transition: all 0.2s ease-in-out;
}

.segmented-control button.active {
    background-color: white;
    color: var(--text-dark);
    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
}

.info-container {
    display: flex;
    flex-direction: column;
    gap: 16px;
}

.info-card {
    background-color: white;
    border-radius: 12px;
    padding: 0 16px;
}

.detail-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 16px 0;
    border-bottom: 1px solid #f0f2f5;
}
.detail-row.no-border {
    border-bottom: none;
}
.detail-row > div:first-child {
    display: flex;
    flex-direction: column;
}
.detail-label {
    font-size: 13px;
    color: var(--text-gray);
    margin-bottom: 2px;
}
.detail-value {
    font-size: 16px;
    color: var(--text-dark);
}
.detail-value.bold {
    font-weight: 500;
}
.detail-value.gray {
    color: var(--text-gray);
}
.detail-actions {
    display: flex;
    gap: 16px;
}
.icon-action-button {
    background: none;
    border: none;
    padding: 0;
    cursor: pointer;
}
.share-data-button {
    background: none;
    border: none;
    color: var(--active-blue);
    font-size: 16px;
    font-weight: 500;
    cursor: pointer;
    padding: 12px 0;
    text-align: left;
}
.info-section-header {
    font-size: 13px;
    color: var(--text-gray);
    font-weight: 500;
    padding: 16px 0;
    border-bottom: 1px solid #f0f2f5;
}
.no-movements {
    text-align: center;
    color: var(--text-gray);
    padding: 32px;
}

/* --- Movements List Styles --- */
.movements-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0 0 12px 0;
    font-size: 13px;
    color: var(--text-gray);
    font-weight: 500;
    margin: 0;
}

.filter-button {
    background: none;
    border: none;
    color: var(--active-blue);
    font-weight: 500;
    font-size: 13px;
    cursor: pointer;
}

.movement-list {
    background-color: white;
    border-radius: 12px;
    padding: 0 16px;
}

.movement-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 14px 0;
    border-bottom: 1px solid #f0f2f5;
}

.movement-item:last-child {
    border-bottom: none;
}

.movement-details {
    display: flex;
    flex-direction: column;
}

.movement-description {
    font-size: 15px;
    color: var(--text-dark);
    max-width: 200px;
}

.movement-date {
    font-size: 13px;
    color: var(--text-gray);
    margin-top: 2px;
}

.movement-amount {
    font-size: 16px;
    font-weight: 500;
    color: var(--text-dark);
    white-space: nowrap;
}

/* --- Token Page Styles --- */
.token-page-container {
    width: 100%;
    height: 100%;
    background-color: var(--background-gray);
    display: flex;
    flex-direction: column;
}

.token-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px 16px;
    padding-top: 40px; /* Safe area */
    border-bottom: 1px solid var(--border-color);
}

.token-header .icon-button {
    color: var(--text-dark);
}

.token-title {
    font-size: 18px;
    font-weight: 500;
    color: var(--text-dark);
}

.token-main {
    flex-grow: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 24px;
    text-align: center;
}

.token-warning {
    display: flex;
    align-items: center;
    gap: 12px;
    background-color: #fef5e7;
    border: 1px solid #fdebd0;
    border-radius: 8px;
    padding: 12px;
    font-size: 14px;
    color: #856404;
    margin-bottom: 48px;
}

.token-warning p {
    text-align: left;
}

.token-display {
    margin-bottom: 32px;
}

.token-label {
    font-size: 16px;
    color: var(--text-gray);
}

.token-code {
    font-size: 52px;
    font-weight: 300;
    letter-spacing: 4px;
    color: var(--text-dark);
    margin-top: 8px;
}

.token-timer {
    width: 100%;
    max-width: 300px;
    margin-bottom: 48px;
}

.token-timer p {
    font-size: 14px;
    color: var(--text-gray);
    margin-bottom: 12px;
}

.progress-bar-container {
    width: 100%;
    height: 4px;
    background-color: #e9ecef;
    border-radius: 2px;
    overflow: hidden;
}

.progress-bar {
    height: 100%;
    background-color: var(--active-blue);
    border-radius: 2px;
    transition: width 1s linear;
}

.token-unlock {
    margin-top: auto;
    padding-bottom: 32px;
}

.token-unlock p {
    font-size: 14px;
    color: var(--text-gray);
    margin-bottom: 8px;
}

.unlock-button {
    background: none;
    border: none;
    color: #e74c3c;
    font-size: 16px;
    font-weight: 500;
    cursor: pointer;
}

/* --- More Page Styles --- */
.more-page {
    padding-top: 8px !important;
}

.more-page-title {
    font-size: 28px;
    font-weight: 700;
    margin-bottom: 16px;
    margin-top: 0;
}

.profile-card {
    display: flex;
    align-items: center;
    gap: 16px;
    cursor: pointer;
}

.profile-avatar {
    width: 48px;
    height: 48px;
    border-radius: 50%;
    background-color: #e0e7ff;
    color: #4338ca;
    display: flex;
    justify-content: center;
    align-items: center;
    font-weight: 500;
    font-size: 18px;
}

.profile-info {
    flex-grow: 1;
    display: flex;
    flex-direction: column;
}

.profile-name {
    font-size: 16px;
    font-weight: 500;
    color: var(--text-dark);
}

.profile-subtext {
    font-size: 14px;
    color: var(--text-gray);
}

.menu-section {
    margin-top: 24px;
}

.menu-section-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 12px;
    padding: 0 4px;
}

.menu-section-header h2 {
    font-size: 20px;
    font-weight: 700;
    color: var(--text-dark);
}

.menu-list {
    padding: 0 16px;
}

.menu-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    width: 100%;
    padding: 16px 0;
    background: none;
    border: none;
    cursor: pointer;
    text-align: left;
    border-bottom: 1px solid #f0f2f5;
}

.menu-item:last-child {
    border-bottom: none;
}

.menu-item span {
    font-size: 16px;
    color: var(--text-dark);
}

.menu-item-right-content {
    display: flex;
    align-items: center;
    gap: 8px;
}

.new-badge {
    background-color: #e6f7ff;
    color: #0069d9;
    font-size: 12px;
    font-weight: 500;
    padding: 4px 8px;
    border-radius: 12px;
}

.session-control-card {
    margin-top: 24px;
    padding: 0;
}

.session-button {
    width: 100%;
    text-align: left;
    padding: 16px;
    background: none;
    border: none;
    font-size: 16px;
    color: var(--active-blue);
    cursor: pointer;
    font-weight: 400;
}

.session-button:first-child {
    border-bottom: 1px solid #f0f2f5;
}

.version-info {
    text-align: center;
    margin-top: 24px;
    padding-bottom: 8px;
    color: var(--text-gray);
    font-size: 12px;
    line-height: 1.5;
}

/* --- Profile Page Styles --- */
.profile-page-container {
    width: 100%;
    height: 100%;
    background-color: #f0f2f5;
    display: flex;
    flex-direction: column;
}

.profile-page {
    padding-top: 16px !important;
    padding-bottom: 16px !important;
    background-color: #f0f2f5;
}

.profile-form-card {
    padding: 0 16px;
    margin-bottom: 16px;
}

.profile-section-header {
    font-size: 16px;
    font-weight: 700;
    color: var(--text-dark);
    padding: 16px 0;
    border-bottom: 1px solid #f0f2f5;
    margin: 0 -16px 8px -16px;
    padding-left: 16px;
}

.form-group {
    display: flex;
    flex-direction: column;
    padding: 12px 0;
    border-bottom: 1px solid #f0f2f5;
}

.form-group.no-border {
    border-bottom: none;
}

.form-group label {
    font-size: 13px;
    color: var(--text-gray);
    margin-bottom: 8px;
}

.form-group input {
    border: none;
    background-color: transparent;
    font-size: 16px;
    color: var(--text-dark);
    padding: 0;
}
.form-group input:focus {
    outline: none;
}
.form-group input:disabled,
.form-group input[readOnly] {
    color: var(--text-gray);
    background-color: #f8f9fa;
    cursor: not-allowed;
    font-family: monospace;
    font-size: 15px;
}

.save-profile-button {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    width: 100%;
    margin-top: 24px;
    padding: 14px;
    background-color: var(--active-blue);
    color: white;
    border: none;
    border-radius: 8px;
    font-size: 16px;
    font-weight: 500;
    cursor: pointer;
    transition: background-color 0.2s;
}
.save-profile-button:hover {
    background-color: #00418a;
}
.save-profile-button:disabled {
    background-color: #a0b1c2;
    cursor: not-allowed;
}
.save-profile-button svg {
    stroke: white;
    width: 20px;
    height: 20px;
}

.balance-input-group {
    display: flex;
    align-items: center;
    gap: 4px;
}
.balance-input-group span {
    font-size: 16px;
    color: var(--text-gray);
    font-weight: 500;
}
.balance-input-group input {
    flex-grow: 1;
}
.balance-input-group .cents-input {
    flex-grow: 0;
    width: 30px;
    text-align: center;
}
.balance-input-group input:disabled {
    background-color: #f1f3f5;
    color: var(--text-gray);
}


.profile-section-header-with-action {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 16px 0;
    border-bottom: 1px solid #f0f2f5;
    margin: 0 -16px 0 -16px;
    padding-left: 16px;
    padding-right: 16px;
}
.profile-section-header.no-padding {
    padding: 0;
    margin: 0;
    border: none;
}
.add-recipient-button {
    background: none;
    border: none;
    cursor: pointer;
    padding: 0;
}
.add-recipient-button svg {
    width: 24px;
    height: 24px;
    stroke: var(--active-blue);
}
.add-recipient-button:disabled svg {
    stroke: #adb5bd;
}

.recipient-form-container {
    padding-top: 16px;
    border-bottom: 1px solid #e0e0e0;
}
.recipient-form-container:last-child {
    border-bottom: none;
}
.recipient-form-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 12px;
}
.recipient-form-title {
    font-size: 14px;
    font-weight: 500;
    color: var(--text-gray);
}
.remove-recipient-button {
    background: none;
    border: none;
    cursor: pointer;
    padding: 0;
}
.remove-recipient-button:disabled {
    cursor: not-allowed;
    opacity: 0.5;
}

.account-form-container {
    padding-bottom: 8px;
    margin-bottom: 16px;
    border-bottom: 2px solid #e9ecef;
}
.account-form-container:last-child {
    margin-bottom: 0;
    border-bottom: none;
}
.account-form-title {
    font-size: 15px;
    font-weight: 500;
    color: var(--text-gray);
    margin-bottom: 16px;
    padding-top: 16px;
}
.account-form-container:first-child .account-form-title {
    padding-top: 0;
}

.balance-label-container {
    display: flex;
    justify-content: space-between;
    align-items: center;
}
.balance-label-container label {
    margin-bottom: 0;
}
.unlock-balance-button {
    background-color: #e9ecef;
    border: none;
    border-radius: 20px;
    padding: 4px 10px;
    font-size: 12px;
    font-weight: 500;
    color: var(--text-dark);
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 4px;
    transition: background-color 0.2s;
}
.unlock-balance-button:hover {
    background-color: #dee2e6;
}
.unlock-balance-button svg {
    stroke: var(--text-dark);
    width: 14px;
    height: 14px;
}


/* --- Admin Password Modal --- */
.admin-password-modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: rgba(0, 0, 0, 0.6);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 10002;
}
.admin-password-modal-content {
    background: white;
    padding: 24px;
    border-radius: 16px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.3);
    width: 90%;
    max-width: 320px;
    text-align: center;
}
.admin-modal-header {
    margin-bottom: 24px;
}
.admin-modal-header h2 {
    font-size: 20px;
    font-weight: 700;
    margin-bottom: 8px;
}
.admin-modal-header p {
    font-size: 14px;
    color: var(--text-gray);
}
.admin-password-input {
    width: 100%;
    padding: 12px;
    border: 1px solid var(--border-color);
    border-radius: 8px;
    font-size: 16px;
    text-align: center;
    margin-bottom: 8px;
}
.admin-password-input:focus {
    outline: none;
    border-color: var(--active-blue);
    box-shadow: 0 0 0 2px rgba(0, 87, 184, 0.2);
}
.admin-password-error {
    color: var(--notification-red);
    font-size: 14px;
    margin-bottom: 16px;
    min-height: 20px;
}
.admin-modal-actions {
    display: flex;
    gap: 12px;
    margin-top: 16px;
}
.admin-modal-button {
    flex: 1;
    padding: 12px;
    border: none;
    border-radius: 8px;
    font-size: 16px;
    font-weight: 500;
    cursor: pointer;
    transition: background-color 0.2s;
}
.admin-modal-button.cancel {
    background-color: #e9ecef;
    color: var(--text-dark);
}
.admin-modal-button.unlock {
    background-color: var(--active-blue);
    color: white;
}


/* --- Transferencias Page Styles --- */
.transfer-options-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 12px;
    margin-bottom: 24px;
}

.transfer-option-card {
    background-color: var(--card-bg);
    border-radius: 12px;
    padding: 16px;
    box-shadow: 0 1px 4px rgba(0,0,0,0.04);
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    min-height: 110px;
    cursor: pointer;
}

.transfer-option-card .icon-container {
    width: 36px;
    height: 36px;
    border-radius: 8px;
    background-color: #fff2e6; /* Light orange */
    color: #d97706; /* Darker orange */
    display: flex;
    justify-content: center;
    align-items: center;
    margin-bottom: 16px;
}

.transfer-option-card .icon-container svg {
    width: 24px;
    height: 24px;
}

.transfer-option-card span {
    font-size: 15px;
    font-weight: 500;
    color: var(--text-dark);
    line-height: 1.3;
}

.favorite-contacts-card {
    padding: 24px 16px;
    display: flex;
    flex-direction: column;
    text-align: center;
    min-height: 250px;
}

.favorite-contacts-card h2 {
    font-size: 18px;
    font-weight: 700;
    color: var(--text-dark);
    margin-bottom: 16px;
    width: 100%;
    text-align: left;
}

.no-recipients-info {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    text-align: center;
    flex-grow: 1;
    gap: 12px;
}
.fav-contacts-main-text {
    font-size: 16px;
    font-weight: 500;
    color: var(--text-dark);
    max-width: 300px;
    line-height: 1.4;
}
.fav-contacts-sub-text {
    font-size: 14px;
    color: var(--text-gray);
    max-width: 280px;
}
.go-to-contacts-link {
    display: flex;
    justify-content: space-between;
    align-items: center;
    text-decoration: none;
    margin-top: 24px;
    padding-top: 16px;
    border-top: 1px solid var(--border-color);
}
.go-to-contacts-link span {
    font-size: 16px;
    font-weight: 500;
    color: var(--active-blue);
}
.go-to-contacts-link svg {
    stroke: var(--active-blue);
}

/* --- Transfer Flow Header Styles --- */
.app-header.alias-transfer-header {
    background-color: var(--background-gray);
    color: var(--text-dark);
    border-bottom: 1px solid var(--border-color);
}
.app-header.app-header-confirm {
    background-color: var(--background-gray);
    color: var(--text-dark);
    border-bottom: 1px solid var(--border-color);
}
.app-header-confirm .close-button,
.app-header-confirm .back-button,
.alias-transfer-header .more-button {
    position: absolute;
}
.app-header-confirm .back-button { left: 8px; }
.app-header-confirm .close-button { right: 8px; }
.alias-transfer-header .more-button { right: 8px; }


/* --- Alias Transfer Page --- */
.alias-transfer-page-container {
    display: flex;
    flex-direction: column;
    height: 100%;
    background-color: var(--background-gray);
}
.alias-transfer-main {
    flex-grow: 1;
    padding: 24px 16px;
}
.alias-transfer-main h2 {
    font-size: 22px;
    font-weight: 500;
    margin-bottom: 24px;
}
.alias-input {
    width: 100%;
    border: none;
    border-bottom: 2px solid #ced4da;
    background-color: transparent;
    padding: 8px 0;
    font-size: 18px;
    color: var(--text-dark);
}
.alias-input:focus {
    outline: none;
    border-bottom-color: var(--orange-accent);
}
.alias-transfer-footer {
    padding: 16px;
    background-color: var(--background-gray);
}
.continue-button {
    width: 100%;
    padding: 14px;
    background-color: var(--orange-accent);
    color: white;
    border: none;
    border-radius: 8px;
    font-size: 16px;
    font-weight: 700;
    cursor: pointer;
}
.continue-button:disabled {
    background-color: #fdcb6e;
    cursor: not-allowed;
}


/* --- Confirm Transfer Page --- */
.confirm-transfer-page-container {
    display: flex;
    flex-direction: column;
    height: 100%;
    background-color: white;
}
.confirm-transfer-main {
    flex-grow: 1;
    padding: 24px 16px;
}
.main-title-container {
    margin-bottom: 24px;
}
.main-title {
    font-size: 24px;
    font-weight: 700;
}
.details-group {
    margin-bottom: 20px;
}
.details-intro {
    font-size: 14px;
    color: var(--text-gray);
    margin-bottom: 4px;
}
.recipient-name {
    font-size: 18px;
    font-weight: 500;
    color: var(--text-dark);
}
.detail-label {
    font-size: 14px;
    color: var(--text-gray);
    margin-bottom: 4px;
}
.detail-value {
    font-size: 16px;
    color: var(--text-dark);
    font-weight: 400;
}
.divider {
    border: none;
    border-top: 1px solid var(--border-color);
    margin: 24px 0;
}
.contact-status {
    font-size: 14px;
    color: var(--success-green);
    font-weight: 500;
}
.confirm-transfer-footer {
    padding: 16px;
    background-color: white;
    box-shadow: 0 -2px 5px rgba(0,0,0,0.05);
}
.confirm-continue-button {
    width: 100%;
    padding: 14px;
    background-color: var(--orange-accent);
    color: white;
    border: none;
    border-radius: 8px;
    font-size: 16px;
    font-weight: 700;
    cursor: pointer;
}

/* --- Amount Transfer Page --- */
.amount-transfer-page-container {
    display: flex;
    flex-direction: column;
    height: 100%;
    background-color: white;
}
.amount-transfer-main {
    flex-grow: 1;
    padding: 24px 16px;
    overflow-y: auto;
}
.transfer-question {
    font-size: 22px;
    font-weight: 500;
    margin-bottom: 24px;
}
.amount-input-container {
    display: flex;
    align-items: baseline;
    border-bottom: 2px solid var(--orange-accent);
    margin-bottom: 8px;
}
.currency-symbol {
    font-size: 28px;
    color: var(--text-gray);
    padding-bottom: 8px;
}
.amount-input {
    flex-grow: 1;
    border: none;
    background: none;
    font-size: 40px;
    font-weight: 700;
    color: var(--text-dark);
    padding: 8px;
    text-align: left;
}
.amount-input:focus { outline: none; }
.daily-limit {
    font-size: 13px;
    color: var(--text-gray);
    margin-bottom: 32px;
}
.account-selection-section { margin-top: 24px; }
.account-selection-title {
    font-size: 18px;
    font-weight: 700;
    margin-bottom: 4px;
}
.account-selection-subtitle {
    font-size: 14px;
    color: var(--text-gray);
    margin-bottom: 16px;
}
.account-options-list {
    display: flex;
    flex-direction: column;
    gap: 12px;
}
.account-option-card {
    display: flex;
    align-items: center;
    justify-content: space-between;
    background-color: #f8f9fa;
    border-radius: 12px;
    padding: 12px;
    cursor: pointer;
}
.account-option-main { display: flex; align-items: center; gap: 12px; }
.account-option-icon {
    width: 48px;
    height: 48px;
    border-radius: 8px;
    background-color: white;
    border: 1px solid var(--border-color);
    display: flex;
    justify-content: center;
    align-items: center;
    font-weight: 700;
    font-size: 14px;
}
.fima-icon-content {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 2px;
}
.fima-text { font-size: 10px; color: var(--active-blue); }
.account-option-details { display: flex; flex-direction: column; }
.account-option-balance { font-size: 16px; font-weight: 500; }
.account-option-name { font-size: 13px; color: var(--text-gray); }
.custom-checkbox input { display: none; }
.custom-checkbox .checkmark {
    width: 24px;
    height: 24px;
    border: 2px solid #adb5bd;
    border-radius: 50%;
    display: inline-block;
    position: relative;
}
.custom-checkbox input:checked + .checkmark {
    background-color: var(--orange-accent);
    border-color: var(--orange-accent);
}
.custom-checkbox input:checked + .checkmark:after {
    content: '';
    position: absolute;
    left: 7px;
    top: 3px;
    width: 6px;
    height: 12px;
    border: solid white;
    border-width: 0 3px 3px 0;
    transform: rotate(45deg);
}
.amount-transfer-footer {
    padding: 16px;
    background-color: white;
    box-shadow: 0 -2px 5px rgba(0,0,0,0.05);
}
.amount-transfer-continue-button {
    width: 100%;
    padding: 14px;
    background-color: var(--orange-accent);
    color: white;
    border: none;
    border-radius: 8px;
    font-size: 16px;
    font-weight: 700;
    cursor: pointer;
}
.amount-transfer-continue-button:disabled {
    background-color: #fdcb6e;
    cursor: not-allowed;
}

/* Amount Transfer - Details Step */
.amount-transfer-main.details-step {
    padding-top: 8px;
}
.transfer-recipient-info {
    font-size: 14px;
    color: var(--text-gray);
    text-align: center;
}
.transfer-amount-display {
    font-size: 40px;
    font-weight: 700;
    text-align: center;
    margin: 4px 0;
}
.transfer-source-account {
    font-size: 14px;
    text-align: center;
    color: var(--text-gray);
    margin-bottom: 32px;
}
.transfer-details-form {
    display: flex;
    flex-direction: column;
    gap: 20px;
}
.form-group-transfer {
    display: flex;
    flex-direction: column;
    gap: 8px;
}
.form-group-transfer label {
    font-size: 14px;
    color: var(--text-gray);
}
.select-wrapper {
    position: relative;
}
.select-wrapper::after {
    content: '▼';
    font-size: 12px;
    color: var(--text-gray);
    position: absolute;
    right: 12px;
    top: 50%;
    transform: translateY(-50%);
    pointer-events: none;
}
.form-group-transfer select, .form-group-transfer input {
    width: 100%;
    padding: 12px;
    border: 1px solid var(--border-color);
    border-radius: 8px;
    background-color: white;
    font-size: 16px;
    appearance: none;
}
.input-with-counter {
    position: relative;
}
.char-counter {
    position: absolute;
    right: 12px;
    top: 50%;
    transform: translateY(-50%);
    font-size: 12px;
    color: var(--text-gray);
}


/* --- Final Confirmation Page --- */
.final-confirmation-page-container {
    display: flex;
    flex-direction: column;
    height: 100%;
    background-color: white;
}
.final-confirmation-main {
    flex-grow: 1;
    padding: 24px 16px;
    text-align: center;
}
.final-confirmation-intro {
    font-size: 14px;
    color: var(--text-gray);
}
.final-confirmation-amount {
    font-size: 40px;
    font-weight: 700;
    margin: 4px 0 32px 0;
}
.final-confirmation-details {
    display: flex;
    flex-direction: column;
    gap: 16px;
    text-align: left;
    background-color: #f8f9fa;
    padding: 16px;
    border-radius: 12px;
}
.detail-item {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
}
.detail-item-label {
    font-size: 14px;
    color: var(--text-gray);
}
.detail-item-value {
    font-size: 14px;
    font-weight: 500;
    color: var(--text-dark);
    max-width: 60%;
    text-align: right;
}
.final-confirmation-footer {
    padding: 16px;
    background-color: white;
    box-shadow: 0 -2px 5px rgba(0,0,0,0.05);
}
.footer-note {
    font-size: 12px;
    color: var(--text-gray);
    text-align: center;
    margin-bottom: 12px;
}
.confirm-button {
    width: 100%;
    padding: 14px;
    background-color: var(--active-blue);
    color: white;
    border: none;
    border-radius: 8px;
    font-size: 16px;
    font-weight: 700;
    cursor: pointer;
}

/* --- Processing Transfer Page --- */
.processing-transfer-container {
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    height: 100%;
    background-color: white;
    gap: 24px;
}
.processing-spinner {
    width: 60px;
    height: 60px;
    border: 5px solid #e9ecef;
    border-top-color: var(--orange-accent);
    border-radius: 50%;
    animation: spin 1s linear infinite;
}
.processing-text {
    font-size: 18px;
    font-weight: 500;
    text-align: center;
    line-height: 1.5;
}

/* --- Transfer Receipt Page --- */
.transfer-receipt-container {
    display: flex;
    flex-direction: column;
    height: 100%;
    background-color: var(--background-gray);
    padding: 16px;
    padding-top: 40px; /* Safe area */
}
.fima-ad-banner {
    background: linear-gradient(to right, #4a90e2, #2c6eb5);
    color: white;
    border-radius: 12px;
    padding: 16px;
    display: flex;
    align-items: center;
    gap: 16px;
    margin-bottom: 24px;
    position: relative;
}
.ad-content { flex-grow: 1; }
.ad-content h3 { font-size: 16px; margin-bottom: 4px; }
.ad-content p { font-size: 13px; opacity: 0.9; }
.dismiss-ad-button {
    position: absolute;
    top: 8px;
    right: 8px;
    background: none;
    border: none;
    cursor: pointer;
}
.receipt-main {
    flex-grow: 1;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    text-align: center;
}
.receipt-success-icon {
    margin-bottom: 24px;
}
.receipt-message {
    font-size: 20px;
    font-weight: 400;
    line-height: 1.5;
}
.receipt-amount, .receipt-recipient {
    font-weight: 700;
}
.receipt-footer {
    display: flex;
    flex-direction: column;
    gap: 12px;
}
.receipt-action-primary, .receipt-action-secondary {
    width: 100%;
    padding: 14px;
    border: none;
    border-radius: 8px;
    font-size: 16px;
    font-weight: 700;
    cursor: pointer;
}
.receipt-action-primary {
    background-color: var(--active-blue);
    color: white;
}
.receipt-action-secondary {
    background-color: #e9ecef;
    color: var(--text-dark);
}
                    </style>
                </head>
                <body>
                    <div id="root"></div>
                    <script>
                        
                // --- VANILLA JS REIMPLEMENTATION OF THE APP ---
                
                // --- DATA ---
                const accountsData = [
  {
    "type": "Caja de ahorro en pesos",
    "balance": "2.567.106",
    "cents": "48",
    "currency": "$",
    "number": "Nº 4015282-1 097-2",
    "alias": "ROMERO.DIETA.DELTA",
    "cbu": "00700979-30004015282128",
    "cuil": "20-11387130-0",
    "titular": "ANDRES FERNANDO TELLERIA ",
    "actions": [
      {
        "label": "Transferir dinero",
        "icon": "transfer"
      },
      {
        "label": "Ingresar dinero",
        "icon": "deposit"
      },
      {
        "label": "Copiar CBU",
        "icon": "copy"
      }
    ],
    "movements": [
      {
        "description": "Transferencia a terceros",
        "amount": -113500,
        "originalDate": "08/10/25"
      },
      {
        "description": "Pago de servicios",
        "amount": -702767.62,
        "originalDate": "07/10/25"
      },
      {
        "description": "Ing. brutos s/ cred",
        "amount": -1.2,
        "originalDate": "06/10/25"
      },
      {
        "description": "Transferencia de terceros",
        "amount": 12000,
        "originalDate": "06/10/25"
      },
      {
        "description": "Deb. autom. de serv.",
        "amount": -15553,
        "originalDate": "06/10/25"
      },
      {
        "description": "Ing. brutos s/ cred",
        "amount": -12.28,
        "originalDate": "06/10/25"
      },
      {
        "description": "Transferencia de terceros",
        "amount": 122797,
        "originalDate": "06/10/25"
      },
      {
        "description": "Ing. brutos s/ cred",
        "amount": -1.2,
        "originalDate": "03/10/25"
      },
      {
        "description": "Transferencia de terceros",
        "amount": 12000,
        "originalDate": "03/10/25"
      },
      {
        "description": "Ing. brutos s/ cred",
        "amount": -1.2,
        "originalDate": "03/10/25"
      },
      {
        "description": "Transferencia de terceros",
        "amount": 12000,
        "originalDate": "03/10/25"
      }
    ]
  },
  {
    "type": "Caja de ahorro en dólares",
    "balance": "79.981",
    "cents": "60",
    "currency": "U$D",
    "number": "Nº 4004892-5 097-3",
    "alias": "VERDE.VUELTA.DELTA",
    "cbu": "00700979-31004004892533",
    "cuil": "20-11387130-0",
    "titular": "ANDRES FERNANDO TELLERIA",
    "actions": [
      {
        "label": "Transferir dinero",
        "icon": "transfer"
      },
      {
        "label": "Comprar / Vender",
        "icon": "usd"
      },
      {
        "label": "Copiar CBU",
        "icon": "copy"
      }
    ],
    "movements": [
      {
        "description": "Transferencia de terceiros",
        "amount": 195,
        "originalDate": "07/10/25"
      },
      {
        "description": "Pago tarjeta visa",
        "amount": -2125.6,
        "originalDate": "29/09/25"
      },
      {
        "description": "Rescate fima",
        "amount": 0.01,
        "originalDate": "29/09/25"
      },
      {
        "description": "Interes capitalizado",
        "amount": 0.01,
        "originalDate": "22/09/25"
      },
      {
        "description": "Pago tarjeta visa",
        "amount": -352.53,
        "originalDate": "27/08/25"
      },
      {
        "description": "Rescate fima",
        "amount": 100,
        "originalDate": "25/08/25"
      },
      {
        "description": "Suscripcion fima",
        "amount": -100,
        "originalDate": "25/08/25"
      },
      {
        "description": "Interes capitalizado",
        "amount": 0.01,
        "originalDate": "22/08/25"
      },
      {
        "description": "Transferencia de cuenta propia",
        "amount": 10000,
        "originalDate": "11/08/25"
      },
      {
        "description": "Pago tarjeta visa",
        "amount": -310.5,
        "originalDate": "28/07/25"
      },
      {
        "description": "Interes capitalizado",
        "amount": 0.01,
        "originalDate": "22/07/25"
      }
    ]
  }
];
                const cardsData = [
  {
    "brand": "VISA",
    "type": "Crédito",
    "number": "**** **** **** 2634",
    "fullNumber": "4593 5400 1347 2634",
    "validFrom": "01/24",
    "expiry": "11/28",
    "cvv": "233",
    "className": "visa-credit-card-black"
  },
  {
    "brand": "VISA",
    "type": "Débito",
    "number": "**** **** **** 2469",
    "fullNumber": "4517 6901 7489 2469",
    "validFrom": "08/25",
    "expiry": "09/31",
    "cvv": "432",
    "className": "visa-debit-card"
  }
];
                const transferRecipientsData = [
  {
    "id": 1,
    "userId": "HPUSE2C1",
    "recipientName": "Juarez Nicolas Rodolfo",
    "cbu": "4530000800014238109707",
    "destinationBank": "Naranja X",
    "cuit": "20400108340",
    "alias": "NARANJA.FANTA.PAN"
  }
];
                const userData = {
  "userId": "0IBB0A9K",
  "name": "Andres Fernando Telleria",
  "alias": "ROMERO.DIETA.DELTA",
  "cuil": "20-11387130-0",
  "email": "andres.telleria@example.com",
  "phone": "11 2345-6789"
};

                // --- HELPERS ---
                const generateUniqueId = () => Math.random().toString(36).substring(2, 10).toUpperCase();

                // --- STATE ---
                let state = {
                    isLoggedIn: false,
                    isAppLoading: true,
                    currentPage: 'home',
                    selectedAccount: null,
                    initialTab: 'Información',
                    isQrMode: false,
                    timers: {
                        qr: null,
                        token: null
                    },
                    tarjetasLoadingState: 'idle',
                    tarjetasVisibleCardIndex: null,
                    tarjetasTargetCardIndex: null,
                    tarjetasActiveIndex: 0,
                    isProcessingTransfer: false,
                    currentTransfer: {
                        amount: '2.000',
                        sourceAccount: 'CA $ 4081369-9 116-1',
                        sourceAccountNumber: null,
                        concept: 'Varios',
                        motivo: '',
                        recipientName: '',
                        cbu: '',
                        destinationBank: '',
                        cuit: '',
                        alias: '',
                        step: 'amount',
                    },
                    profile: {
                        isSaving: false,
                        isUnlocked: false,
                        showPasswordModal: false,
                        passwordInput: '',
                        passwordError: '',
                    }
                };

                // --- ICON HELPERS (Return SVG strings) ---
                const ICONS = {
                    EyeIcon: () => '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"><\/path><circle cx="12" cy="12" r="3"><\/circle><\/svg>',
                    QuestionIcon: () => '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"><\/circle><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"><\/path><line x1="12" y1="17" x2="12.01" y2="17"><\/line><\/svg>',
                    BellIcon: () => '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"><\/path><path d="M13.73 21a2 2 0 0 1-3.46 0"><\/path><\/svg>',
                    TransferIcon: () => '<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24" fill="none" stroke="#0057b8" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M16 10H4l3-3"/><path d="M8 14h12l-3 3"/></svg>',
                    DepositIcon: () => '<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24" fill="none" stroke="#0057b8" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M3 6.5c2-2 5-2 7 0s5 2 7 0" /><path d="M3 17.5c2 2 5 2 7 0s5-2 7 0" /><path d="M3 6.5v11" /><path d="M21 6.5v11" /><path d="M12 14.5v-3M13 10A1.5 1.5 0 0 0 12 8.5a1.5 1.5 0 0 0-1 1.5" /><path d="M14 12a1.5 1.5 0 0 0-1-1.5 1.5 1.5 0 0 0-1 1.5" /></svg>',
                    CopyIcon: () => '<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24" fill="none" stroke="#0057b8" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"><\/rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"><\/path><\/svg>',
                    UsdIcon: () => '<span class="usd-icon">U$D</span>',
                    StarIcon: () => '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24" fill="none" stroke="#868e96" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"><\/polygon><\/svg>',
                    ChevronRightIcon: () => '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24" fill="none" stroke="#868e96" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6"><\/polyline><\/svg>',
                    ChevronLeftIcon: () => '<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6"><\/polyline><\/svg>',
                    MoreHorizontalIcon: () => '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="1"><\/circle><circle cx="19" cy="12" r="1"><\/circle><circle cx="5" cy="12" r="1"><\/circle><\/svg>',
                    PencilIcon: () => '<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24" fill="none" stroke="#0057b8" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"><\/path><\/svg>',
                    CopyIconSmall: () => '<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24" fill="none" stroke="#0057b8" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"><\/rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"><\/path><\/svg>',
                    FimaIcon: () => '<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24" fill="none" stroke="#0057b8" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M3 3v18h18" /><path d="M7 14l4-4 4 4 5-5" /></svg>',
                    FimaBarIcon: () => '<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24" fill="none" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="20" x2="12" y2="10"></line><line x1="18" y1="20" x2="18" y2="4"></line><line x1="6" y1="20" x2="6" y2="16"></line></svg>',
                    TokenIcon: () => '<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24" fill="none" stroke="#0057b8" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="7" width="18" height="8" rx="2" ry="2"><\/rect><circle cx="8" cy="11" r="0.5" fill="#0057b8" stroke="none"><\/circle><circle cx="12" cy="11" r="0.5" fill="#0057b8" stroke="none"><\/circle><circle cx="16" cy="11" r="0.5" fill="#0057b8" stroke="none"><\/circle><rect x="14" y="13" width="6" height="5" rx="1" fill="white"><\/rect><rect x="14" y="13" width="6" height="5" rx="1"><\/rect><path d="M18 13v-1.5a2 2 0 0 0-4 0v1.5"><\/path><circle cx="17" cy="15.5" r="0.5" fill="#0057b8" stroke="none"><\/circle><\/svg>',
                    PlusIcon: () => '<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24" fill="none" stroke="#0057b8" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"><\/line><line x1="5" y1="12" x2="19" y2="12"><\/line><\/svg>',
                    ArrowRightCircleIcon: () => '<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24" fill="#0057b8" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"><\/circle><polyline points="12 16 16 12 12 8"><\/polyline><line x1="8" y1="12" x2="16" y2="12"><\/line><\/svg>',
                    HomeIcon: () => '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"><\/path><polyline points="9 22 9 12 15 12 15 22"><\/polyline><\/svg>',
                    CardIcon: () => '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="1" y="4" width="22" height="16" rx="2" ry="2"><\/rect><line x1="1" y1="10" x2="23" y2="10"><\/line><\/svg>',
                    TransfersIcon: () => '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="17 1 21 5 17 9"><\/polyline><path d="M3 11V9a4 4 0 0 1 4-4h14"><\/path><polyline points="7 23 3 19 7 15"><\/polyline><path d="M21 13v2a4 4 0 0 1-4 4H3"><\/path><\/svg>',
                    MoreIcon: () => '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="12" x2="21" y2="12"><\/line><line x1="3" y1="6" x2="21" y2="6"><\/line><line x1="3" y1="18" x2="21" y2="18"><\/line><\/svg>',
                    FaceIdIcon: () => '<svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" viewBox="0 0 24" fill="none" stroke="#0057b8" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M4 8V6a2 2 0 0 1 2-2h2"/><path d="M4 16v2a2 2 0 0 0 2 2h2"/><path d="M16 4h2a2 2 0 0 1 2 2v2"/><path d="M16 20h2a2 2 0 0 0 2-2v-2"/><path d="M9 10h.01"/><path d="M15 10h.01"/><path d="M10 14a3.5 3.5 0 0 0 4 0"/></svg>',
                    DownloadIcon: () => '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24" fill="none" stroke="#0057b8" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"><\/path><polyline points="7 10 12 15 17 10"><\/polyline><line x1="12" y1="15" x2="12" y2="3"><\/line><\/svg>',
                    GenerateTokenIcon: () => '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24" fill="none" stroke="#0057b8" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M20 17.5a2.5 2.5 0 0 1-2.5 2.5H8.5L4 22V6.5A2.5 2.5 0 0 1 6.5 4h11A2.5 2.5 0 0 1 20 6.5v11z"/><rect x="9" y="10" width="6" height="4" rx="1"><\/rect><path d="M10.5 10V9a1.5 1.5 0 0 1 3 0v1"><\/path><\/svg>',
                    ModoIcon: () => '<svg width="40" height="40" viewBox="0 0 40 40" xmlns="http://www.w3.org/2000/svg"><text x="50%" y="55%" dominant-baseline="middle" text-anchor="middle" fill="white" font-size="28" font-weight="700" font-family="Roboto, sans-serif">M<\/text><\/svg>',
                    QrCodeIcon: () => '<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24" fill="none" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="7" height="7"><\/rect><rect x="14" y="3" width="7" height="7"><\/rect><rect x="3" y="14" width="7" height="7"><\/rect><rect x="14" y="14" width="7" height="7"><\/rect><\/svg>',
                    CloseIcon: () => '<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"><\/line><line x1="6" y1="6" x2="18" y2="18"><\/line><\/svg>',
                    InfoIcon: () => '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24" fill="none" stroke="#e74c3c" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"><\/circle><line x1="12" y1="16" x2="12" y2="12"><\/line><line x1="12" y1="8" x2="12.01" y2="8"><\/line><\/svg>',
                    WarningIcon: () => '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24" fill="none" stroke="#e67e22" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"><\/path><line x1="12" y1="9" x2="12" y2="13"><\/line><line x1="12" y1="17" x2="12.01" y2="17"><\/line><\/svg>',
                    PayCardIcon: () => '<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24" fill="none" stroke="#0057b8" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M3.5 8.5C3.5 7 5 5.5 6.5 5.5h11C19 5.5 20.5 7 20.5 8.5v8c0 1.5-1.5 3-3 3H10c-3.5 0-4.5-2-4.5-4 0-1 .5-2.5 2-3"/><path d="M12 12.5a2 2 0 0 0-2-2" /><path d="M12 15.5a2 2 0 0 1 2-2" /><path d="M12 10v1.5" /><path d="M12 16.5v1.5" /></svg>',
                    PinResetIcon: () => '<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24" fill="none" stroke="#0057b8" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="7" width="20" height="14" rx="2" /><path d="M6 13h.01M10 13h.01M14 13h.01M6 17h.01M10 17h.01M14 17h.01" /><path d="M2 11h20" /></svg>',
                    PauseCardIcon: () => '<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24" fill="none" stroke="#0057b8" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"><\/rect><path d="M7 11V7a5 5 0 0 1 10 0v4"><\/path><\/svg>',
                    ReportCardIcon: () => '<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24" fill="none" stroke="#0057b8" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><rect x="1" y="4" width="22" height="16" rx="2" ry="2" /><path d="M9 9h6v6H9z" /><path d="M9 1v3" /><path d="M15 1v3" /><path d="M9 20v3" /><path d="M15 20v3" /></svg>',
                    MoreGesturesIcon: () => '<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24" fill="#0057b8"><circle cx="6" cy="12" r="1.5"><\/circle><circle cx="12" cy="12" r="1.5"><\/circle><circle cx="18" cy="12" r="1.5"><\/circle><\/svg>',
                    NoUsageIcon: () => '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24" fill="none" stroke="#6c757d" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"><\/path><\/svg>',
                    ValidatingIcon: () => '<svg class="validating-icon" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24" fill="none" stroke="#212529" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="7" width="18" height="8" rx="2" ry="2"><\/rect><circle cx="8" cy="11" r="0.5" fill="#212529" stroke="none"><\/circle><circle cx="12" cy="11" r="0.5" fill="#212529" stroke="none"><\/circle><circle cx="16" cy="11" r="0.5" fill="#212529" stroke="none"><\/circle><rect x="14" y="13" width="6" height="5" rx="1" fill="white"><\/rect><rect x="14" y="13" width="6" height="5" rx="1"><\/rect><path d="M18 13v-1.5a2 2 0 0 0-4 0v1.5"><\/path><circle cx="17" cy="15.5" r="0.5" fill="#212529" stroke="none"><\/circle><\/svg>',
                    FinancialManagementIcon: () => '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24" fill="none" stroke="#6c757d" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M2 22h20"/><path d="M4 10v11"/><path d="M9 10v11"/><path d="M15 10v11"/><path d="M20 10v11"/><path d="M2 10l10-7 10 7"/></svg>',
                    SecurityIcon: () => '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24" fill="none" stroke="#6c757d" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z" /><circle cx="12" cy="11" r="3" /><path d="M15 17a5 5 0 0 0-6 0" /></svg>',
                    BenefitsIcon: () => '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24" fill="none" stroke="#6c757d" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 12 20 22 4 22 4 12"><\/polyline><rect x="2" y="7" width="20" height="5"><\/rect><line x1="12" y1="22" x2="12" y2="7"><\/line><path d="M12 7H7.5a2.5 2.5 0 0 1 0-5C9.81 2 12 4.19 12 7z"><\/path><path d="M12 7h4.5a2.5 2.5 0 0 0 0-5C14.19 2 12 4.19 12 7z"><\/path></svg>',
                    CustomerSupportIcon: () => '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24" fill="none" stroke="#6c757d" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"><\/rect><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"><\/path><line x1="12" y1="17" x2="12.01" y2="17"><\/line></svg>',
                    AliasIcon: () => '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 17l5-5-5-5"/><path d="M10 7L5 12l5 5"/></svg>',
                    CellphoneModoIcon: () => '<svg width="24" height="24" viewBox="0 0 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><text x="50%" y="55%" dominant-baseline="middle" text-anchor="middle" fill="currentColor" font-size="16" font-weight="700" font-family="Roboto, sans-serif">M</text></svg>',
                    MyAccountsIcon: () => '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="8.5" cy="7" r="4"/><path d="M18 8a5 5 0 1 1-5 5"/><path d="M20 10h1v1"/></svg>',
                    MoreOptionsIcon: () => '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M7 17l9.2-9.2M17 17V7H7"/></svg>',
                    FolderIcon: () => '<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24" fill="none" stroke="#6c757d" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"><\/path><\/svg>',
                    CheckCircleIcon: () => '<svg width="80" height="80" viewBox="0 0 80 80" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="40" cy="40" r="38" stroke="#66d1b7" stroke-width="4"/><path d="M26 41.5L36.5 52L56.5 32" stroke="#212529" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/></svg>',
                    FimaAdIcon: () => '<svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="12" y="10" width="24" height="28" rx="3" fill="white" stroke="#e0e0e0" stroke-width="2"/><path d="M18 20h12" stroke="#4a90e2" stroke-width="2" stroke-linecap="round"/><path d="M18 26h6" stroke="#4a90e2" stroke-width="2" stroke-linecap="round"/><circle cx="32" cy="16" r="6" fill="#f5a623"/><text x="32" y="18" fill="white" font-size="9" font-weight="bold" text-anchor="middle">S</text></svg>',
                    DismissIcon: () => '<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24" fill="none" stroke="#888" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"><\/line><line x1="6" y1="6" x2="18" y2="18"><\/line><\/svg>',
                    InfoIconOrange: () => '<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24" fill="none" stroke="#f39c12" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"><\/circle><line x1="12" y1="16" x2="12" y2="12"><\/line><line x1="12" y1="8" x2="12.01" y2="8"><\/line><\/svg>',
                    OrangeChevronLeftIcon: () => '<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24" fill="none" stroke="#f39c12" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6"><\/polyline><\/svg>',
                    OrangeCloseIcon: () => '<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24" fill="none" stroke="#f39c12" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"><\/line><line x1="6" y1="6" x2="18" y2="18"><\/line><\/svg>',
                    SaveIcon: () => '<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"><\/path><polyline points="17 21 17 13 7 13 7 21"><\/polyline><polyline points="7 3 7 8 15 8"><\/polyline><\/svg>',
                    LockIcon: () => '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"><\/rect><path d="M7 11V7a5 5 0 0 1 10 0v4"><\/path><\/svg>',
                    TrashIcon: () => '<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24" fill="none" stroke="#e74c3c" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"><\/polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"><\/path><line x1="10" y1="11" x2="10" y2="17"><\/line><line x1="14" y1="11" x2="14" y2="17"><\/line><\/svg>',
                };
                
                const iconMap = {
                    transfer: ICONS.TransferIcon(),
                    deposit: ICONS.DepositIcon(),
                    copy: ICONS.CopyIcon(),
                    usd: ICONS.UsdIcon(),
                    fima: ICONS.FimaIcon(),
                    plus: ICONS.PlusIcon(),
                };

                // --- HELPERS ---
                const formatCurrency = (amount, currency) => {
                    const formattedAmount = new Intl.NumberFormat('es-AR', {
                        minimumFractionDigits: 2,
                        maximumFractionDigits: 2,
                    }).format(Math.abs(amount));
                    return amount < 0 ? `-${currency}${formattedAmount}` : `${currency}${formattedAmount}`;
                };

                async function handleUpdateApp(button) {
                    if (!('serviceWorker' in navigator)) {
                        alert('La actualización automática no es compatible con tu navegador.');
                        return;
                    }

                    button.disabled = true;
                    const span = button.querySelector('span');
                    if (span) span.textContent = 'Actualizando...';

                    try {
                        const registrations = await navigator.serviceWorker.getRegistrations();
                        for (const registration of registrations) {
                            await registration.unregister();
                        }

                        const keys = await caches.keys();
                        await Promise.all(keys.map(key => caches.delete(key)));
                        
                        alert('La aplicación se actualizará. La página se recargará ahora.');
                        window.location.reload();

                    } catch (error) {
                        console.error('Error al forzar la actualización:', error);
                        alert('Ocurrió un error al actualizar. Por favor, intente de nuevo.');
                        button.disabled = false;
                        if (span) span.textContent = 'Generar Token Galica';
                    }
                }

                // --- RENDER FUNCTIONS (Return HTML strings) ---
                
                function renderLoginPage() {
                    const firstName = userData?.name?.split(' ')[0] || 'Usuario';
                    return `
                        <div class="login-container">
                            <header class="login-top-nav">
                                <button class="login-link-button">Cambiar usuario</button>
                            </header>
                            <main class="login-main">
                                <h1 class="login-greeting">¡Hola, ${firstName}! <span role="img" aria-label="smiling face">😄</span></h1>
                                <form id="login-form" class="login-form">
                                    <input
                                        id="password-input"
                                        type="password"
                                        placeholder="Clave Galica"
                                        class="login-input"
                                        maxlength="4"
                                        pattern="\\d*"
                                        inputmode="numeric"
                                        autofocus
                                    />
                                    <p id="login-error" class="login-error" style="display: none;"></p>
                                </form>
                                <button class="login-link-button recover-password">Recuperar Clave Galica</button>
                                <div class="login-actions-group">
                                    <button class="face-id-button">
                                        ${ICONS.FaceIdIcon()}
                                        <span>Ingresar con Face ID</span>
                                    </button>
                                     <button class="download-app-button" data-action="download-app">
                                        ${ICONS.DownloadIcon()}
                                        <span>Descargar Aplicación</span>
                                    </button>
                                </div>
                            </main>
                            <footer class="login-footer">
                                <button class="generate-token-button" data-action="update-app">
                                    ${ICONS.GenerateTokenIcon()}
                                    <span>Generar Token Galica</span>
                                </button>
                                <p class="login-help-text">
                                    ¿Necesitás ayuda para ingresar? <a href="#" class="login-help-link">Ir a Ayuda</a>
                                </p>
                            </footer>
                        </div>
                    `;
                }

                function renderHeader() {
                    const page = state.currentPage;
                    const account = state.selectedAccount;

                    if (page === 'tarjetas' || page === 'transferencias') {
                        const title = page === 'tarjetas' ? 'Tarjetas' : 'Transferencias';
                        return `<header class="app-header app-header-page"><h1 class="header-title">${title}</h1><div class="header-actions"><button class="icon-button">${ICONS.QuestionIcon()}</button></div></header>`;
                    }
                    if (page === 'aliasTransfer') {
                        return `<header class="app-header app-header-detail alias-transfer-header"><button class="icon-button back-button" data-action="go-to-transferencias" aria-label="Volver">${ICONS.ChevronLeftIcon()}</button><div class="header-detail-title"><p>Cuenta de destino</p></div><button class="icon-button more-button" aria-label="Información">${ICONS.InfoIconOrange()}</button></header>`;
                    }
                    if (['confirmTransfer', 'amountTransfer', 'finalConfirmTransfer'].includes(page)) {
                        let title = 'Nueva transferencia';
                        if (page === 'confirmTransfer') title = 'Datos de la cuenta';
                        else if (page === 'finalConfirmTransfer') title = 'Revisá y confirmá';
                        
                        let backAction = 'go-to-alias-transfer';
                        if (page === 'amountTransfer') backAction = 'go-to-confirm-transfer';
                        if (page === 'finalConfirmTransfer') backAction = 'go-to-amount-transfer';

                        return `<header class="app-header app-header-confirm"><button class="icon-button back-button" data-action="${backAction}" aria-label="Volver">${ICONS.OrangeChevronLeftIcon()}</button><div class="header-detail-title"><p>${title}</p></div><button class="icon-button close-button" data-action="go-to-transferencias" aria-label="Cerrar">${ICONS.OrangeCloseIcon()}</button></header>`;
                    }
                    if (page === 'accountDetail' && account) {
                        return `<header class="app-header app-header-detail"><button class="icon-button back-button" data-action="go-back" aria-label="Volver">${ICONS.ChevronLeftIcon()}</button><div class="header-detail-title"><p>CA ${account.currency}${account.balance},${account.cents}</p><p>${account.number}</p></div><button class="icon-button more-button" aria-label="Más opciones">${ICONS.MoreHorizontalIcon()}</button></header>`;
                    }
                    if (page === 'more' || page === 'profile') {
                        return '';
                    }

                    return `<header class="app-header"><img src="https://iili.io/KGzjc92.png" alt="Galica Logo" class="header-logo" /><div class="header-actions"><button class="icon-button">${ICONS.EyeIcon()}</button><button class="icon-button">${ICONS.QuestionIcon()}</button><button class="icon-button">${ICONS.BellIcon()}</button></div></header>`;
                }
                
                function renderBottomNav() {
                     return `
                        <footer class="bottom-nav">
                            <button class="nav-item ${['home', 'accountDetail'].includes(state.currentPage) ? 'active' : ''}" data-navigate="home">
                                ${ICONS.HomeIcon()}
                                <span>Inicio</span>
                            </button>
                            <button class="nav-item ${state.currentPage === 'tarjetas' ? 'active' : ''}" data-navigate="tarjetas">
                                ${ICONS.CardIcon()}
                                <span>Tarjetas</span>
                            </button>
                            <button id="central-button" class="central-button ${state.isQrMode ? 'is-flipped' : ''}" aria-label="Acción principal">
                                <div class="flipper">
                                    <div class="front">${ICONS.ModoIcon()}</div>
                                    <div class="back">${ICONS.QrCodeIcon()}</div>
                                </div>
                            </button>
                            <button class="nav-item ${['transferencias', 'aliasTransfer', 'confirmTransfer', 'amountTransfer', 'finalConfirmTransfer'].includes(state.currentPage) ? 'active' : ''}" data-navigate="transferencias">
                                ${ICONS.TransfersIcon()}
                                <span>Transferencias</span>
                            </button>
                             <button class="nav-item ${['more', 'profile'].includes(state.currentPage) ? 'active' : ''}" data-navigate="more">
                                ${ICONS.MoreIcon()}
                                <span>Más</span>
                            </button>
                        </footer>
                    `;
                }

                function renderHomePage() {
                    const accountCardsHTML = accountsData.map((account, index) => `
                        <div class="account-slide" data-action="select-account" data-account-index="${index}">
                            <div class="account-slide-card">
                                <div class="account-header">
                                    <div>
                                        <p class="account-type">${account.type}</p>
                                        <p class="account-balance">${account.currency} ${account.balance}<sup>${account.cents}</sup></p>
                                        <p class="account-number">${account.number}</p>
                                    </div>
                                    ${ICONS.StarIcon()}
                                </div>
                                <div class="account-actions">
                                    ${account.actions.map(action => `
                                        <div class="action-item">
                                            <button class="action-button" aria-label="${action.label}">${iconMap[action.icon]}</button>
                                            <span>${action.label}</span>
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                        </div>
                    `).join('');

                    const shortcutsHTML = `
                        <div class="shortcuts-section">
                            <h2>Accesos directos</h2>
                            <div class="shortcuts-grid">
                                <div class="shortcut-item"><button class="shortcut-button"><span class="fima-label">FIMA</span>${ICONS.FimaIcon()}</button><span>Agregar / Retirar</span></div>
                                <div class="shortcut-item"><button class="shortcut-button"><span class="usd-shortcut">U$D</span></button><span>Comprar / Vender</span></div>
                                <div class="shortcut-item" data-navigate="token"><button class="shortcut-button" aria-label="Ver Token Galica">${ICONS.TokenIcon()}</button><span>Ver Token Galica</span></div>
                                <div class="shortcut-item"><button class="shortcut-button">${ICONS.PlusIcon()}</button><span>Más accesos</span></div>
                            </div>
                        </div>
                    `;

                    return `
                        <main class="app-main">
                            <div class="accounts-section"><div class="account-carousel-wrapper">${accountCardsHTML}</div></div>
                            <div class="card upcoming-payments"><span>PRÓXIMOS VENCIMIENTOS</span><div class="payment-details"><span class="notification-badge">1</span>${ICONS.ChevronRightIcon()}</div></div>
                            <div class="card insurance-ad"><div class="insurance-text"><h3>Tenemos un seguro para todo lo que necesitás.</h3><p>Ver seguros</p></div>${ICONS.ChevronRightIcon()}</div>
                            ${shortcutsHTML}
                            <div class="cards-section">
                                <h2>Tarjetas</h2>
                                <div class="cards-container">
                                    <div class="card visa-card">
                                        <h4>VISA</h4>
                                        <p class="card-type">Crédito</p>
                                        <p class="card-info">Tu resumen está listo.<br/>Vence el 06/10</p>
                                        <p class="card-last-four">2634</p>
                                    </div>
                                    <div class="card go-to-cards-card">
                                        ${ICONS.ArrowRightCircleIcon()}
                                        <span>Ir a Tarjetas</span>
                                    </div>
                                </div>
                            </div>
                        </main>
                    `;
                }
                
                // ... [Existing renderTarjetasPage, renderAccountDetailPage, etc.]
                function renderCardInfoSectionHTML() {
                    const activeIndex = state.tarjetasActiveIndex;
                    const infoSectionHTML = activeIndex === 0 ? `
                        <div class="card resumen-card">
                            <p class="resumen-info">Tu resumen está listo y vence el 06/10</p>
                            <p class="resumen-total">Total: $ 4.898.870,35 + USD 2.125,60</p>
                            <button class="resumen-action">
                                <span>Mostrar resumen</span>
                                ${ICONS.ChevronRightIcon()}
                            </button>
                        </div>
                    ` : `
                        <div class="card no-usage-info-card">
                            ${ICONS.NoUsageIcon()}
                            <p>Todavía no usaste la tarjeta</p>
                        </div>
                        <div class="card card-info-table">
                            <h3>Información de tu tarjeta</h3>
                            <div class="debit-card-info-row">
                                <span>Límite de compra</span>
                                <span>$ 1.500.000</span>
                            </div>
                            <div class="debit-card-info-row">
                                <span>Límite de extracción</span>
                                <span>$ 400.000</span>
                            </div>
                        </div>
                    `;
                    return infoSectionHTML;
                }

                function renderCardInfoSection() {
                    const container = document.getElementById('card-info-section');
                    if (container) {
                        container.innerHTML = renderCardInfoSectionHTML();
                    }
                }

                function renderTarjetasPage() {
                    const cardsHTML = cardsData.map((card, index) => `
                        <div class="tarjeta-slide">
                            <div class="tarjeta-card ${card.className}">
                                <div class="tarjeta-header">
                                    <div class="tarjeta-brand">
                                        <span class="visa-logo-text">${card.brand}</span>
                                        <span class="tarjeta-debit-text">${card.type}</span>
                                    </div>
                                    <button class="mostrar-datos-btn" data-action="toggle-card-data" data-card-index="${index}">
                                        ${state.tarjetasVisibleCardIndex === index ? 'Ocultar datos' : 'Mostrar datos'} ${ICONS.EyeIcon()}
                                    </button>
                                </div>
                                <div class="tarjeta-number">
                                    <span>${state.tarjetasVisibleCardIndex === index ? card.fullNumber : card.number}</span>
                                </div>
                                <div class="tarjeta-details">
                                    <div>
                                        <span class="tarjeta-label">Fecha de vencimiento</span>
                                        <span class="tarjeta-value">${state.tarjetasVisibleCardIndex === index ? card.expiry : '••/••'}</span>
                                    </div>
                                    <div>
                                        <span class="tarjeta-label">Código de seguridad</span>
                                        <span class="tarjeta-value">${state.tarjetasVisibleCardIndex === index ? card.cvv : '•••'}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `).join('');

                    return `
                    <main class="app-main tarjetas-page">
                        <div class="tarjetas-carousel-wrapper">
                            ${cardsHTML}
                        </div>
                        <div class="card tarjeta-actions-grid">
                            <div class="tarjeta-action-item"><button class="action-button">${ICONS.PayCardIcon()}</button><span>Pagar tarjeta</span></div>
                            <div class="tarjeta-action-item"><button class="action-button">${ICONS.PauseCardIcon()}</button><span>Pausar tarjeta</span></div>
                            <div class="tarjeta-action-item"><button class="action-button">${ICONS.ReportCardIcon()}</button><span>Denunciar tarjeta</span></div>
                            <div class="tarjeta-action-item"><button class="action-button">${ICONS.MoreGesturesIcon()}</button><span>Más gestiones</span></div>
                        </div>
                        <div id="card-info-section">${renderCardInfoSectionHTML()}</div>
                        <div class="card movimientos-card">
                            <button class="resumen-action">
                                <span>Mostrar movimientos</span>
                                ${ICONS.ChevronRightIcon()}
                            </button>
                        </div>
                        <div class="card actividad-card">
                            <h3>Actividad</h3>
                            ${ICONS.NoUsageIcon()}
                            <p>Todavía no tenés movimientos pendientes de ingresar a tu tarjeta.</p>
                        </div>
                    </main>
                    `;
                }

                function renderAccountDetailPage() {
                    const account = state.selectedAccount;
                    if (!account) return '<p>Error: No hay una cuenta seleccionada.</p>';

                    const infoTabHTML = `
                    <div class="info-container">
                        <div class="info-card"><div class="detail-row"><div><span class="detail-label">Alias de CBU</span><span class="detail-value">${account.alias}</span></div><div class="detail-actions"><button class="icon-action-button">${ICONS.PencilIcon()}</button><button class="icon-action-button">${ICONS.CopyIconSmall()}</button></div></div><div class="detail-row"><div><span class="detail-label">Número de Cuenta</span><span class="detail-value">${account.number.replace('Nº ', '')}</span></div></div><div class="detail-row"><div><span class="detail-label">CBU</span><span class="detail-value">${account.cbu}</span></div><div class="detail-actions"><button class="icon-action-button">${ICONS.CopyIconSmall()}</button></div></div><div class="detail-row no-border"><div><span class="detail-label">CUIL</span><span class="detail-value">${account.cuil}</span></div></div></div>
                        <button class="share-data-button">Compartir Datos</button>
                        <div class="info-card"><p class="info-section-header">MÁS INFORMACIÓN</p><div class="detail-row"><span class="detail-value gray">${account.titular}</span></div><div class="detail-row no-border"><span class="detail-value bold">Titular Impositivo</span></div></div>
                        <div class="info-card"><div class="detail-row"><span class="detail-label">Valores a acreditar</span><span class="detail-value bold">${account.currency}0,00</span></div><div class="detail-row no-border"><span class="detail-label">Adelanto CAS</span><span class="detail-value bold">${account.currency}0,00</span></div></div>
                    </div>`;
                    const movementsTabHTML = `
                    <div class="info-container">
                        ${account.movements && account.movements.length > 0 ? `
                            <div class="movements-header"><span>ÚLTIMOS MOVIMIENTOS</span><button class="filter-button">FILTRAR</button></div>
                            <div class="movement-list">
                                ${account.movements.map((movement, index) => `
                                    <div class="movement-item">
                                        <div class="movement-details"><span class="movement-description">${movement.description}</span><span class="movement-date">${movement.originalDate}</span></div>
                                        <span class="movement-amount">${formatCurrency(movement.amount, account.currency)}</span>
                                    </div>
                                `).join('')}
                            </div>
                        ` : '<p class="no-movements">No hay movimientos para mostrar.</p>'}
                    </div>`;
                    return `
                    <main class="app-main account-detail-page">
                        <div class="segmented-control">
                            <button class="${state.initialTab === 'Información' ? 'active' : ''}" data-action="switch-tab" data-tab="Información">Información</button>
                            <button class="${state.initialTab === 'Movimientos' ? 'active' : ''}" data-action="switch-tab" data-tab="Movimientos">Movimientos</button>
                        </div>
                        <div id="tab-content">${state.initialTab === 'Información' ? infoTabHTML : movementsTabHTML}</div>
                    </main>`;
                }
                
                function renderHomePageSkeleton() {
                    return `
                        <main class="app-main">
                            <div class="skeleton skeleton-account-card"></div>
                            <div class="skeleton skeleton-upcoming-payments"></div>
                            <div class="skeleton skeleton-insurance"></div>
                            <div class="skeleton skeleton-shortcuts"></div>
                            <div class="skeleton skeleton-cards"></div>
                        </main>
                    `;
                }

                 function renderTokenPage() {
                    return `
                        <div class="token-page-container">
                             <header class="token-header">
                                <button class="icon-button" data-action="go-back" aria-label="Cerrar">${ICONS.CloseIcon()}</button>
                                <h1 class="token-title">Token Galica</h1>
                                <button class="icon-button" aria-label="Información">${ICONS.InfoIcon()}</button>
                            </header>
                            <main class="token-main">
                                <div class="token-warning">
                                    ${ICONS.WarningIcon()}
                                    <p>Nunca compartas tu Token con nadie. Ni siquiera con nosotros.</p>
                                </div>
                                <div class="token-display">
                                    <span class="token-label">Código Token:</span>
                                    <h2 id="token-code" class="token-code">...</h2>
                                </div>
                                <div class="token-timer">
                                    <p id="token-countdown">Este código se renovará en 39 segundos</p>
                                    <div class="progress-bar-container">
                                        <div id="token-progress-bar" class="progress-bar" style="width: 100%;"></div>
                                    </div>
                                </div>
                                <div class="token-unlock">
                                    <p>¿Lo tenés bloqueado?</p>
                                    <button class="unlock-button">Desbloquear Token</button>
                                </div>
                            </main>
                        </div>
                    `;
                }

                function renderMorePage() {
                    const financialMenuItems = ['Inversiones', 'Compra/Venta de Dólares', 'Préstamos', 'Pago de servicios', 'MODO', 'Seguros', 'NFT Galicia', 'Transferencias internacionales'];
                    const securityMenuItems = ['Token Galicia', 'Claves'];
                    const benefitsMenuItems = ['Promociones y ahorros', 'Tus Viajes'];
                    const supportMenuItems = ['Ayuda', 'Cajeros y Sucursales'];

                    return `
                    <main class="app-main more-page">
                        <h1 class="more-page-title">Más</h1>
                        <div class="card profile-card" data-navigate="profile">
                            <div class="profile-avatar">AT</div>
                            <div class="profile-info">
                                <span class="profile-name">${userData.name}</span>
                                <span class="profile-subtext">Información personal</span>
                            </div>
                            ${ICONS.ChevronRightIcon()}
                        </div>
                        <div class="menu-section">
                            <div class="menu-section-header">
                                <h2>Gestión financiera</h2>
                                ${ICONS.FinancialManagementIcon()}
                            </div>
                            <div class="card menu-list">
                                ${financialMenuItems.map(item => `
                                    <button class="menu-item">
                                        <span>${item}</span>
                                        ${ICONS.ChevronRightIcon()}
                                    </button>
                                `).join('')}
                            </div>
                        </div>
                        <div class="menu-section">
                            <div class="menu-section-header">
                                <h2>Seguridad</h2>
                                ${ICONS.SecurityIcon()}
                            </div>
                            <div class="card menu-list">
                                ${securityMenuItems.map(item => `
                                    <button class="menu-item">
                                        <span>${item}</span>
                                        ${ICONS.ChevronRightIcon()}
                                    </button>
                                `).join('')}
                            </div>
                        </div>
                        <div class="menu-section">
                            <div class="menu-section-header">
                                <h2>Beneficios</h2>
                                ${ICONS.BenefitsIcon()}
                            </div>
                             <div class="card menu-list">
                                ${benefitsMenuItems.map(item => `
                                    <button class="menu-item">
                                        <span>${item}</span>
                                        <div class="menu-item-right-content">
                                            ${item === 'Tus Viajes' ? '<span class="new-badge">Nuevo</span>' : ''}
                                            ${ICONS.ChevronRightIcon()}
                                        </div>
                                    </button>
                                `).join('')}
                            </div>
                        </div>
                         <div class="menu-section">
                            <div class="menu-section-header">
                                <h2>Atención al cliente</h2>
                                ${ICONS.CustomerSupportIcon()}
                            </div>
                            <div class="card menu-list">
                                ${supportMenuItems.map(item => `
                                    <button class="menu-item">
                                        <span>${item}</span>
                                        ${ICONS.ChevronRightIcon()}
                                    </button>
                                `).join('')}
                            </div>
                        </div>
                        <div class="card session-control-card">
                            <button class="session-button">Cambiar de sesión</button>
                            <button class="session-button">Cerrar sesión</button>
                        </div>
                        <div class="version-info">
                            <p>Versión 9.21.4</p>
                            <p>Último ingreso: 06/10/2025 21:55:58</p>
                        </div>
                    </main>
                    `;
                }
                
                function renderTransferenciasPage() {
                    return `
                    <main class="app-main transferencias-page">
                        <div class="transfer-options-grid">
                            <div class="transfer-option-card" data-navigate="aliasTransfer">
                                <div class="icon-container">${ICONS.AliasIcon()}</div>
                                <span>A un Alias, CBU o CVU</span>
                            </div>
                            <div class="transfer-option-card">
                                <div class="icon-container">${ICONS.CellphoneModoIcon()}</div>
                                <span>A un celular</span>
                            </div>
                            <div class="transfer-option-card">
                                <div class="icon-container">${ICONS.MyAccountsIcon()}</div>
                                <span>A una de mis cuentas</span>
                            </div>
                            <div class="transfer-option-card">
                                 <div class="icon-container">${ICONS.MoreOptionsIcon()}</div>
                                <span>Más opciones</span>
                            </div>
                        </div>
                         <div class="card favorite-contacts-card">
                            <h2>Contactos favoritos</h2>
                            <div class="no-recipients-info">
                                ${ICONS.FolderIcon()}
                                <p class="fav-contacts-main-text">Agregá hasta 4 contactos favoritos para transferirles más rápido</p>
                                <p class="fav-contacts-sub-text">Podés elegirlos y editarlos en tu lista de contactos.</p>
                            </div>
                            <a href="#" class="go-to-contacts-link" data-navigate="profile">
                                <span>Ir a Contactos</span>
                                ${ICONS.ChevronRightIcon()}
                            </a>
                        </div>
                    </main>`;
                }

                function renderAliasTransferPage() {
                    return `
                    <div class="alias-transfer-page-container">
                        <main class="alias-transfer-main">
                            <h2>Escribí el Alias, CBU o CVU</h2>
                            <input id="alias-input" type="text" class="alias-input" aria-label="Alias, CBU o CVU" autofocus />
                        </main>
                        <footer class="alias-transfer-footer">
                            <button id="alias-continue-btn" class="continue-button" data-action="alias-continue" disabled>Continuar</button>
                        </footer>
                    </div>`;
                }

                function renderConfirmTransferPage() {
                    const details = state.currentTransfer;
                    return `
                    <div class="confirm-transfer-page-container">
                        <main class="confirm-transfer-main">
                            <div class="main-title-container"><h1 class="main-title">Revisá la información</h1></div>
                            <div class="details-group"><p class="details-intro">Los datos corresponden a</p><p class="recipient-name">${details.recipientName}</p></div>
                            <div class="details-group"><p class="detail-label">CUIT</p><p class="detail-value">${details.cuit}</p></div>
                            <div class="details-group"><p class="detail-label">Cuenta en</p><p class="detail-value">${details.destinationBank}</p></div>
                            <div class="details-group"><p class="detail-label">Alias</p><p class="detail-value">${details.alias}</p></div>
                            <div class="details-group"><p class="detail-label">CBU</p><p class="detail-value">${details.cbu}</p></div>
                            <hr class="divider" />
                            <p class="contact-status">Contacto ya agregado</p>
                        </main>
                        <footer class="confirm-transfer-footer">
                            <button class="confirm-continue-button" data-action="go-to-amount-transfer">Continuar</button>
                        </footer>
                    </div>`;
                }

                function renderAmountTransferPage() {
                    const recipientName = state.currentTransfer.recipientName;
                    if (state.currentTransfer.step === 'details') {
                        return `
                        <div class="amount-transfer-page-container">
                            <main class="amount-transfer-main details-step">
                                <p class="transfer-recipient-info">Vas a transferirle a ${recipientName}</p>
                                <p class="transfer-amount-display">$ ${state.currentTransfer.amount}</p>
                                ${state.currentTransfer.sourceAccount ? `<p class="transfer-source-account">Con ${state.currentTransfer.sourceAccount}</p>` : ''}
                                
                                <div class="transfer-details-form">
                                    <div class="form-group-transfer">
                                        <label for="concepto">Concepto</label>
                                        <div class="select-wrapper">
                                            <select id="concepto">
                                                <option ${state.currentTransfer.concept === 'Varios' ? 'selected' : ''}>Varios</option>
                                                <option ${state.currentTransfer.concept === 'Alquiler' ? 'selected' : ''}>Alquiler</option>
                                                <option ${state.currentTransfer.concept === 'Expensas' ? 'selected' : ''}>Expensas</option>
                                                <option ${state.currentTransfer.concept === 'Factura' ? 'selected' : ''}>Factura</option>
                                                <option ${state.currentTransfer.concept === 'Cuota' ? 'selected' : ''}>Cuota</option>
                                                <option ${state.currentTransfer.concept === 'Honorarios' ? 'selected' : ''}>Honorarios</option>
                                                <option ${state.currentTransfer.concept === 'Préstamo' ? 'selected' : ''}>Préstamo</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="form-group-transfer">
                                        <label for="motivo">Motivo</label>
                                        <div class="input-with-counter">
                                            <input 
                                                type="text" 
                                                id="motivo" 
                                                placeholder="Opcional" 
                                                value="${state.currentTransfer.motivo || ''}"
                                                maxlength="12"
                                            />
                                            <span class="char-counter">${(state.currentTransfer.motivo || '').length}/12</span>
                                        </div>
                                    </div>
                                </div>
                            </main>
                            <footer class="amount-transfer-footer">
                                <button class="amount-transfer-continue-button" data-action="amount-transfer-continue">Continuar</button>
                            </footer>
                        </div>
                        `;
                    }

                    const mainPesoAccount = accountsData.find(acc => acc.currency === '$');
                    const sourceAccounts = [];
                    if (mainPesoAccount) {
                        sourceAccounts.push({ id: mainPesoAccount.number, name: mainPesoAccount.type, balance: `${mainPesoAccount.balance},${mainPesoAccount.cents}`, selected: true, type: 'CA' });
                    }
                    sourceAccounts.push({ id: 'FIMA', name: 'Cuenta Fima', balance: '718,70', selected: false, type: 'FIMA' });
                    
                    const accountsHTML = sourceAccounts.map(acc => `
                        <label class="account-option-card">
                            <div class="account-option-main">
                                <div class="account-option-icon">${acc.type === 'CA' ? `<span>CA</span>` : `<div class="fima-icon-content"><span class="fima-text">FIMA</span>${ICONS.FimaBarIcon()}</div>`}</div>
                                <div class="account-option-details"><span class="account-option-balance">$${acc.balance}</span><span class="account-option-name">${acc.name}</span></div>
                            </div>
                            <div class="custom-checkbox">
                                <input type="checkbox" ${acc.selected ? 'checked' : ''} data-action="toggle-source-account" data-account-id="${acc.id}" />
                                <span class="checkmark"></span>
                            </div>
                        </label>
                    `).join('');

                    return `
                    <div class="amount-transfer-page-container">
                        <main class="amount-transfer-main">
                            <h2 class="transfer-question">¿Cuánto querés transferirle a ${recipientName}?</h2>
                            <div class="amount-input-container">
                                <span class="currency-symbol">$</span>
                                <input id="amount-input" type="text" class="amount-input" value="${state.currentTransfer.amount}" inputMode="numeric" placeholder="0" />
                            </div>
                            <p class="daily-limit">Tenés disponible $25.000.000,00 del límite diario</p>
                            <div class="account-selection-section">
                                <h3 class="account-selection-title">Elegí cómo querés transferir</h3>
                                <p class="account-selection-subtitle">Podés seleccionar una cuenta, Cuenta Fima o combinar las 2 opciones.</p>
                                <div class="account-options-list">${accountsHTML}</div>
                            </div>
                        </main>
                        <footer class="amount-transfer-footer">
                            <button class="amount-transfer-continue-button" data-action="amount-transfer-continue">Continuar</button>
                        </footer>
                    </div>`;
                }

                function renderFinalConfirmationPage() {
                    const details = state.currentTransfer;
                    return `
                    <div class="final-confirmation-page-container">
                        <main class="final-confirmation-main">
                            <p class="final-confirmation-intro">Vas a transferirle a ${details.recipientName}</p>
                            <h1 class="final-confirmation-amount">$ ${details.amount}</h1>
                            <div class="final-confirmation-details">
                                <div class="detail-item"><span class="detail-item-label">A su cuenta en</span><span class="detail-item-value">${details.destinationBank}</span></div>
                                <div class="detail-item"><span class="detail-item-label">CBU</span><span class="detail-item-value">${details.cbu}</span></div>
                                <div class="detail-item"><span class="detail-item-label">Desde tu cuenta</span><span class="detail-item-value">${details.sourceAccount}</span></div>
                                <div class="detail-item"><span class="detail-item-label">Concepto</span><span class="detail-item-value">${details.concept}</span></div>
                            </div>
                        </main>
                        <footer class="final-confirmation-footer">
                            <p class="footer-note">Tené en cuenta que la transferencia está sujeta a la confirmación del banco de destino.</p>
                            <button class="confirm-button" data-action="confirm-transfer">Confirmar</button>
                        </footer>
                    </div>`;
                }

                function renderProcessingTransferPage() {
                    return `
                    <div class="processing-transfer-container">
                        <div class="processing-spinner"></div>
                        <p class="processing-text">Estamos procesando tu<br/>transferencia</p>
                    </div>`;
                }

                function renderTransferReceiptPage() {
                    const details = state.currentTransfer;
                    return `
                    <div class="transfer-receipt-container">
                        <div class="fima-ad-banner" id="fima-banner">
                            <div class="ad-content"><h3>¡Usá Cuenta Fima!</h3><p>Pagá tus servicios mientras tu plata crece todos los días.</p></div>
                            <div class="ad-icon">${ICONS.FimaAdIcon()}</div>
                            <button class="dismiss-ad-button" data-action="dismiss-banner" aria-label="Cerrar anuncio">${ICONS.DismissIcon()}</button>
                        </div>
                        <main class="receipt-main">
                            <div class="receipt-success-icon">${ICONS.CheckCircleIcon()}</div>
                            <h1 class="receipt-message">
                                ¡Le transferiste <span class="receipt-amount">$${details.amount}</span> a<br/>
                                <span class="receipt-recipient">${details.recipientName.toUpperCase()}!</span>
                            </h1>
                        </main>
                        <footer class="receipt-footer">
                            <button class="receipt-action-primary">Compartir comprobante</button>
                            <button class="receipt-action-secondary" data-action="go-to-transferencias">Ir a Transferencias</button>
                        </footer>
                    </div>`;
                }

                function renderProfilePage() {
                    const isUnlocked = state.profile.isUnlocked;

                    const passwordModalHTML = state.profile.showPasswordModal ? `
                        <div class="admin-password-modal-overlay">
                            <div class="admin-password-modal-content">
                                <div class="admin-modal-header">
                                    <h2>Acceso de Administrador</h2>
                                    <p>Ingresá la contraseña para poder editar.</p>
                                </div>
                                <form id="admin-password-form">
                                    <input
                                        id="admin-password-input"
                                        type="password"
                                        value="${state.profile.passwordInput}"
                                        class="admin-password-input"
                                        placeholder="Contraseña"
                                        autofocus
                                    />
                                    ${state.profile.passwordError ? `<p class="admin-password-error">${state.profile.passwordError}</p>` : ''}
                                    <div class="admin-modal-actions">
                                        <button type="button" class="admin-modal-button cancel" data-action="close-admin-password-modal">Cancelar</button>
                                        <button type="submit" class="admin-modal-button unlock">Desbloquear</button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    ` : '';
                    
                    const recipientsHTML = transferRecipientsData.map((recipient, index) => `
                        <div class="recipient-form-container" key="${recipient.id || index}">
                            <div class="recipient-form-header">
                                <span class="recipient-form-title">Destinatario ${index + 1}</span>
                                <button type="button" class="remove-recipient-button" data-action="remove-recipient" data-index="${index}" aria-label="Eliminar destinatario">
                                    ${ICONS.TrashIcon()}
                                </button>
                            </div>
                            <div class="form-group">
                                <label for="recipientUserId-${index}">Número de ID del Destinatario</label>
                                <input type="text" id="recipientUserId-${index}" name="userId" value="${recipient.userId || ''}" readonly />
                            </div>
                            <div class="form-group">
                                <label for="recipientName-${index}">Nombre y Apellido del Destinatario</label>
                                <input type="text" id="recipientName-${index}" name="recipientName" value="${recipient.recipientName}" />
                            </div>
                            <div class="form-group">
                                <label for="transferAlias-${index}">Alias / CVU del Destinatario</label>
                                <input type="text" id="transferAlias-${index}" name="alias" value="${recipient.alias}" />
                            </div>
                            <div class="form-group">
                                <label for="transferCuit-${index}">CUIT del Destinatario</label>
                                <input type="text" id="transferCuit-${index}" name="cuit" value="${recipient.cuit}" />
                            </div>
                            <div class="form-group">
                                <label for="transferCbu-${index}">CBU del Destinatario</label>
                                <input type="text" id="transferCbu-${index}" name="cbu" value="${recipient.cbu}" />
                            </div>
                            <div class="form-group no-border">
                                <label for="destinationBank-${index}">Banco del Destinatario</label>
                                <input type="text" id="destinationBank-${index}" name="destinationBank" value="${recipient.destinationBank}" />
                            </div>
                        </div>
                    `).join('');
                    
                    const accountsHTML = accountsData.map((account, index) => `
                        <div key="${index}" class="account-form-container">
                            <h3 class="account-form-title">${account.type}</h3>
                            <div class="form-group">
                                <label for="accountNumber-${index}">Número de Cuenta</label>
                                <input type="text" id="accountNumber-${index}" name="number" value="${account.number.replace('Nº ', '')}" />
                            </div>
                            <div class="form-group">
                                <label for="accountAlias-${index}">Alias de CBU</label>
                                <input type="text" id="accountAlias-${index}" name="alias" value="${account.alias}" />
                            </div>
                            <div class="form-group">
                                <label for="accountCbu-${index}">CBU</label>
                                <input type="text" id="accountCbu-${index}" name="cbu" value="${account.cbu}" />
                            </div>
                            <div class="form-group no-border">
                                <div class="balance-label-container">
                                    <label for="balance-${index}">Saldo</label>
                                    ${!isUnlocked ? `
                                        <button
                                            type="button"
                                            class="unlock-balance-button"
                                            data-action="show-admin-password-modal"
                                            aria-label="Modificar saldo"
                                        >
                                            ${ICONS.LockIcon()}
                                            <span>Modificar</span>
                                        </button>
                                    ` : ''}
                                </div>
                                <div class="balance-input-group">
                                    <span>${account.currency}</span>
                                    <input type="text" id="balance-${index}" name="balance" value="${account.balance}" ${!isUnlocked ? 'disabled' : ''} />
                                    <span>,</span>
                                    <input type="text" class="cents-input" maxlength="2" id="cents-${index}" name="cents" value="${account.cents}" ${!isUnlocked ? 'disabled' : ''} />
                                </div>
                            </div>
                        </div>
                    `).join('');

                    return `
                    ${passwordModalHTML}
                    <div class="profile-page-container">
                        <header class="app-header app-header-detail">
                            <button class="icon-button back-button" data-navigate="more" aria-label="Volver">${ICONS.ChevronLeftIcon()}</button>
                            <div class="header-detail-title">
                                <p>Información Personal</p>
                            </div>
                        </header>
                        <main class="app-main profile-page">
                            <form id="profile-form">
                                <div class="card profile-form-card">
                                    <h2 class="profile-section-header">Mis Datos</h2>
                                    <div class="form-group">
                                        <label for="userId">Número de ID</label>
                                        <input type="text" id="userId" name="userId" value="${userData.userId}" readonly />
                                    </div>
                                    <div class="form-group">
                                        <label for="name">Nombre y Apellido</label>
                                        <input type="text" id="name" name="name" value="${userData.name}" />
                                    </div>
                                    <div class="form-group">
                                        <label for="cuil">Mi CUIL</label>
                                        <input type="text" id="cuil" name="cuil" value="${userData.cuil}" />
                                    </div>
                                    <div class="form-group">
                                        <label for="email">Email</label>
                                        <input type="email" id="email" name="email" value="${userData.email}" />
                                    </div>
                                    <div class="form-group no-border">
                                        <label for="phone">Teléfono</label>
                                        <input type="tel" id="phone" name="phone" value="${userData.phone}" />
                                    </div>
                                </div>
                                <div class="card profile-form-card">
                                    <div class="profile-section-header-with-action">
                                        <h2 class="profile-section-header no-padding">Datos de Destinatarios</h2>
                                        <button type="button" class="add-recipient-button" data-action="add-recipient" aria-label="Agregar destinatario">
                                            ${ICONS.PlusIcon()}
                                        </button>
                                    </div>
                                    ${recipientsHTML}
                                </div>
                                <div class="card profile-form-card">
                                    <h2 class="profile-section-header">Datos de Cuentas</h2>
                                    ${accountsHTML}
                                </div>
                                <button type="submit" class="save-profile-button" ${state.profile.isSaving ? 'disabled' : ''}>
                                    ${ICONS.SaveIcon()}
                                    <span>Guardar Cambios</span>
                                </button>
                            </form>
                        </main>
                    </div>
                    `;
                }


                // --- APP LOGIC ---
                
                function clearTimers() {
                    if (state.timers.qr) clearInterval(state.timers.qr);
                    if (state.timers.token) clearInterval(state.timers.token);
                    state.timers.qr = null;
                    state.timers.token = null;
                }
                
                 function startQrTimer() {
                    if (state.timers.qr) clearInterval(state.timers.qr);
                    state.timers.qr = setInterval(() => {
                        state.isQrMode = true;
                        const button = document.getElementById('central-button');
                        if (button) button.classList.add('is-flipped');

                        setTimeout(() => {
                            state.isQrMode = false;
                            if (button) button.classList.remove('is-flipped');
                        }, 2500);

                    }, 8000);
                }

                function handleNavigation(page) {
                    clearTimers();
                    if (!['accountDetail', 'token', 'profile', 'aliasTransfer', 'confirmTransfer', 'amountTransfer', 'finalConfirmTransfer'].includes(page)) {
                         state.selectedAccount = null;
                    }
                    if (page === 'amountTransfer') {
                        state.currentTransfer.step = 'amount';
                    }
                    if (page !== 'tarjetas') {
                        state.tarjetasLoadingState = 'idle';
                        state.tarjetasVisibleCardIndex = null;
                        state.tarjetasTargetCardIndex = null;
                        state.tarjetasActiveIndex = 0;
                    }
                    state.currentPage = page;
                    render();
                }
                
                function handleLoginSuccess() {
                    const overlay = document.querySelector('.loading-overlay');
                    if (overlay) overlay.remove();
                    state.isLoggedIn = true;
                    setTimeout(() => {
                        state.isAppLoading = false;
                        render();
                    }, 2500);
                    render();
                }

                function render() {
                    const root = document.getElementById('root');
                    if (!root) return;

                    clearTimers();
                    
                    document.querySelectorAll('.wait-modal-overlay, .loading-sequence-overlay, .loading-overlay').forEach(el => el.remove());

                    if (!state.isLoggedIn) {
                        root.innerHTML = renderLoginPage();
                        return;
                    }
                    
                    if (state.isProcessingTransfer) {
                        root.innerHTML = renderProcessingTransferPage();
                        return;
                    }
                    if (state.currentPage === 'transferReceipt') {
                        root.innerHTML = renderTransferReceiptPage();
                        return;
                    }
                    if (state.currentPage === 'token') {
                        root.innerHTML = renderTokenPage();
                        startTokenTimer();
                        return;
                    }
                     if (state.currentPage === 'profile') {
                        root.innerHTML = renderProfilePage();
                        return;
                    }

                    let pageContent = '';
                    if (state.isAppLoading && state.currentPage === 'home') {
                        pageContent = renderHomePageSkeleton();
                    } else {
                        switch(state.currentPage) {
                            case 'home': pageContent = renderHomePage(); break;
                            case 'tarjetas': pageContent = renderTarjetasPage(); break;
                            case 'accountDetail': pageContent = renderAccountDetailPage(); break;
                            case 'more': pageContent = renderMorePage(); break;
                            case 'transferencias': pageContent = renderTransferenciasPage(); break;
                            case 'aliasTransfer': pageContent = renderAliasTransferPage(); break;
                            case 'confirmTransfer': pageContent = renderConfirmTransferPage(); break;
                            case 'amountTransfer': pageContent = renderAmountTransferPage(); break;
                            case 'finalConfirmTransfer': pageContent = renderFinalConfirmationPage(); break;
                            default: pageContent = renderHomePage();
                        }
                    }
                    
                    const showBottomNav = !['token', 'profile', 'aliasTransfer', 'confirmTransfer', 'amountTransfer', 'finalConfirmTransfer'].includes(state.currentPage);

                    root.innerHTML = `
                        <div class="mobile-screen">
                            ${renderHeader()}
                            ${pageContent}
                            ${showBottomNav ? renderBottomNav() : ''}
                        </div>
                    `;
                    
                    if(showBottomNav) startQrTimer();

                    if (state.currentPage === 'tarjetas') {
                        if (state.tarjetasLoadingState === 'wait') {
                             document.body.insertAdjacentHTML('beforeend', '<div class="wait-modal-overlay"><div class="wait-modal-content"><p>Espera un Instante.</p></div></div>');
                        } else if (state.tarjetasLoadingState === 'load') {
                            const loadingSequenceHTML = `<div class="loading-sequence-overlay"><div class="loading-sequence-content"><div class="validation-container">${ICONS.ValidatingIcon()}<div class="loader"></div></div><p>Estamos Validando Este Dispositivo</p></div></div>`;
                             document.body.insertAdjacentHTML('beforeend', loadingSequenceHTML);
                        }
                    }
                }
                
                function startTokenTimer() {
                    let countdown = 39;
                    const totalDuration = 39;

                    const generateToken = () => {
                        const newToken = Math.floor(100000 + Math.random() * 900000).toString();
                        return `${newToken.substring(0, 3)} ${newToken.substring(3, 6)}`;
                    };

                    const updateUI = () => {
                         const codeEl = document.getElementById('token-code');
                         const countdownEl = document.getElementById('token-countdown');
                         const progressEl = document.getElementById('token-progress-bar');
                         if (!codeEl || !countdownEl || !progressEl) {
                             if(state.timers.token) clearInterval(state.timers.token);
                             return;
                         }
                         if (codeEl.textContent === '...') {
                             codeEl.textContent = generateToken();
                         }
                         countdownEl.textContent = `Este código se renovará en ${countdown} segundos`;
                         progressEl.style.width = `${(countdown / totalDuration) * 100}%`;
                    };
                    
                    updateUI();

                    state.timers.token = setInterval(() => {
                        countdown--;
                        if (countdown < 1) {
                            countdown = totalDuration;
                            const codeEl = document.getElementById('token-code');
                            if(codeEl) codeEl.textContent = generateToken();
                        }
                        updateUI();
                    }, 1000);
                }

                // --- EVENT HANDLING ---
                
                function setupEventListeners() {
                    const root = document.getElementById('root');
                    if (!root) return;

                    // Use event delegation on the root element
                    document.body.addEventListener('submit', event => {
                        const form = event.target;
                        if (form.id === 'login-form') {
                            event.preventDefault();
                            attemptLogin();
                        } else if (form.id === 'profile-form') {
                            event.preventDefault();
                            handleProfileSave();
                        } else if (form.id === 'admin-password-form') {
                             event.preventDefault();
                             handleAdminPasswordCheck();
                        }
                    });

                    document.body.addEventListener('input', event => {
                        if (event.target.id === 'password-input') {
                            const passwordInput = event.target;
                            const errorEl = document.getElementById('login-error');
                            if (errorEl && errorEl.style.display !== 'none') errorEl.style.display = 'none';
                            if (passwordInput.value.length === 4) attemptLogin();
                        } else if (event.target.id === 'alias-input') {
                            const aliasInput = event.target;
                            const continueBtn = document.getElementById('alias-continue-btn');
                            if (continueBtn) continueBtn.disabled = !aliasInput.value.trim();
                        } else if (event.target.id === 'amount-input') {
                            const value = event.target.value.replace(/[^\d]/g, '');
                            if (value === '') { event.target.value = ''; return; }
                            const formatted = new Intl.NumberFormat('es-AR').format(parseInt(value, 10));
                            event.target.value = formatted;
                        } else if (event.target.id === 'concepto') {
                            state.currentTransfer.concept = event.target.value;
                        } else if (event.target.id === 'motivo') {
                            state.currentTransfer.motivo = event.target.value;
                            const counter = document.querySelector('.char-counter');
                            if (counter) counter.textContent = `${event.target.value.length}/12`;
                        } else if (event.target.id === 'admin-password-input') {
                            state.profile.passwordInput = event.target.value;
                            if (state.profile.passwordError) {
                                state.profile.passwordError = '';
                                const errorEl = document.querySelector('.admin-password-error');
                                if (errorEl) errorEl.style.display = 'none';
                            }
                        }
                    });

                    document.body.addEventListener('click', event => {
                        const target = event.target.closest('[data-navigate], [data-action]');
                        if (!target) return;

                        const navigateTo = target.dataset.navigate;
                        const action = target.dataset.action;

                        if (navigateTo) {
                            handleNavigation(navigateTo);
                        }

                        if (action) {
                            switch(action) {
                                case 'go-back': handleNavigation('home'); break;
                                case 'go-to-transferencias': handleNavigation('transferencias'); break;
                                case 'go-to-alias-transfer': handleNavigation('aliasTransfer'); break;
                                case 'go-to-confirm-transfer': handleNavigation('confirmTransfer'); break;
                                case 'go-to-amount-transfer': handleNavigation('amountTransfer'); break;
                                case 'amount-transfer-continue':
                                    if (state.currentTransfer.step === 'amount') {
                                        const amountInput = document.getElementById('amount-input');
                                        const sourceAccountEl = document.querySelector('input[data-action="toggle-source-account"]:checked');
                                        
                                        if (amountInput && sourceAccountEl) {
                                            const accountId = sourceAccountEl.dataset.accountId;
                                            const sourceAccountData = accountsData.find(a => a.number === accountId);
                                            const fimaAccount = { type: 'Cuenta Fima' };
                                            const selectedSource = sourceAccountData || (accountId === 'FIMA' ? fimaAccount : null);
                                            
                                            state.currentTransfer.amount = amountInput.value || '0';
                                            state.currentTransfer.sourceAccountNumber = accountId;
                                            state.currentTransfer.sourceAccount = selectedSource ? selectedSource.type : '';
                                        }
                                        
                                        state.currentTransfer.step = 'details';
                                        render();
                                    } else {
                                        handleNavigation('finalConfirmTransfer');
                                    }
                                    break;
                                case 'confirm-transfer':
                                    state.isProcessingTransfer = true;
                                    render();
                                    setTimeout(() => {
                                         // Logic to update balance
                                        const sourceAccount = accountsData.find(acc => acc.number === state.currentTransfer.sourceAccountNumber);
                                        if (sourceAccount) {
                                            const transferAmount = parseFloat(state.currentTransfer.amount.replace(/\./g, '').replace(/,/g, '.'));
                                            const currentBalance = parseFloat(`${sourceAccount.balance.replace(/\./g, '')}.${sourceAccount.cents}`);
                                            const newBalance = currentBalance - transferAmount;
                                            const [newBalanceInt, newCents] = newBalance.toFixed(2).split('.');
                                            sourceAccount.balance = new Intl.NumberFormat('es-AR').format(parseInt(newBalanceInt, 10));
                                            sourceAccount.cents = newCents;
                                            sourceAccount.movements.unshift({
                                                description: `Transferencia a ${state.currentTransfer.recipientName}`,
                                                amount: -transferAmount,
                                                originalDate: new Date().toLocaleDateString('es-AR', { day: '2-digit', month: '2-digit', year: '2-digit'}),
                                            });
                                        }
                                        state.isProcessingTransfer = false;
                                        handleNavigation('transferReceipt');
                                    }, 3500);
                                    break;
                                case 'alias-continue':
                                    const aliasInput = document.getElementById('alias-input');
                                    if (!aliasInput || !aliasInput.value) break;
                                    const inputValue = aliasInput.value;
                                    const foundRecipient = transferRecipientsData.find(r => (r.alias && r.alias.toLowerCase() === inputValue.toLowerCase()) || r.cbu === inputValue);
                                    const newRecipientData = foundRecipient ? foundRecipient : transferRecipientsData[0]; // Default
                                    const isCbu = !isNaN(inputValue.replace(/-/g, '')) && inputValue.length > 20;
                                    
                                    state.currentTransfer = { ...state.currentTransfer, ...newRecipientData,
                                        alias: isCbu ? newRecipientData.alias : inputValue,
                                        cbu: isCbu ? inputValue : newRecipientData.cbu
                                    };
                                    handleNavigation('confirmTransfer');
                                    break;
                                case 'select-account':
                                    const accountIndex = parseInt(target.dataset.accountIndex, 10);
                                    state.selectedAccount = accountsData[accountIndex];
                                    state.initialTab = 'Información';
                                    handleNavigation('accountDetail');
                                    break;
                                case 'switch-tab':
                                    const tab = target.dataset.tab;
                                    if (state.initialTab !== tab) {
                                        state.initialTab = tab;
                                        render();
                                    }
                                    break;
                                case 'dismiss-banner':
                                    const banner = document.getElementById('fima-banner');
                                    if (banner) banner.style.display = 'none';
                                    break;
                                case 'update-app': handleUpdateApp(target); break;
                                case 'download-app': handleDownload(); break;
                                case 'show-admin-password-modal':
                                    state.profile.showPasswordModal = true;
                                    render();
                                    break;
                                case 'close-admin-password-modal':
                                    state.profile.showPasswordModal = false;
                                    state.profile.passwordInput = '';
                                    state.profile.passwordError = '';
                                    render();
                                    break;
                                case 'add-recipient':
                                    transferRecipientsData.push({
                                        id: Date.now(),
                                        userId: generateUniqueId(),
                                        recipientName: '',
                                        alias: '',
                                        cuit: '',
                                        cbu: '',
                                        destinationBank: ''
                                    });
                                    render();
                                    break;
                                case 'remove-recipient':
                                    const removeIndex = parseInt(target.dataset.index, 10);
                                    transferRecipientsData.splice(removeIndex, 1);
                                    render();
                                    break;
                            }
                        }
                    });

                    function attemptLogin() {
                        const passwordInput = document.getElementById('password-input');
                        const errorEl = document.getElementById('login-error');
                        if (!passwordInput || !errorEl) return;
                        if (document.querySelector('.loading-overlay')) return;
                        if (passwordInput.value.length < 4) return;

                        if (passwordInput.value === '2021') {
                            errorEl.style.display = 'none';
                            passwordInput.blur();
                            document.body.insertAdjacentHTML('beforeend', '<div class="loading-overlay"><div class="loader"></div></div>');
                            setTimeout(handleLoginSuccess, 3000);
                        } else {
                            errorEl.textContent = 'Clave incorrecta.';
                            errorEl.style.display = 'block';
                            setTimeout(() => { passwordInput.value = ''; }, 800);
                        }
                    }

                    function handleAdminPasswordCheck() {
                         const passwordInput = document.getElementById('admin-password-input');
                         if (!passwordInput) return;
                         if (passwordInput.value === 'zxcvbnm') {
                             state.profile.isUnlocked = true;
                             state.profile.showPasswordModal = false;
                             state.profile.passwordError = '';
                         } else {
                             state.profile.passwordError = 'Contraseña incorrecta.';
                             state.profile.passwordInput = '';
                         }
                         render();
                    }

                    function handleProfileSave() {
                        if (state.profile.isSaving) return;
                        state.profile.isSaving = true;
                        document.body.insertAdjacentHTML('beforeend', '<div class="wait-modal-overlay"><div class="wait-modal-content"><p>Guardando cambios...</p></div></div>');
                        
                        const form = document.getElementById('profile-form');
                        if (!form) return;

                        // Update userData from form
                        userData.name = form.elements.name.value;
                        userData.cuil = form.elements.cuil.value;
                        userData.email = form.elements.email.value;
                        userData.phone = form.elements.phone.value;

                        // Update recipients
                        const newRecipients = [];
                        const recipientContainers = form.querySelectorAll('.recipient-form-container');
                        recipientContainers.forEach((container, index) => {
                             newRecipients.push({
                                id: transferRecipientsData[index].id,
                                userId: container.querySelector('[name="userId"]').value,
                                recipientName: container.querySelector('[name="recipientName"]').value,
                                alias: container.querySelector('[name="alias"]').value,
                                cuit: container.querySelector('[name="cuit"]').value,
                                cbu: container.querySelector('[name="cbu"]').value,
                                destinationBank: container.querySelector('[name="destinationBank"]').value,
                             });
                        });
                        transferRecipientsData.length = 0;
                        Array.prototype.push.apply(transferRecipientsData, newRecipients);

                        // Update accounts
                        const accountContainers = form.querySelectorAll('.account-form-container');
                        accountContainers.forEach((container, index) => {
                            const account = accountsData[index];
                            account.number = `Nº ${container.querySelector('[name="number"]').value}`;
                            account.alias = container.querySelector('[name="alias"]').value;
                            account.cbu = container.querySelector('[name="cbu"]').value;
                            if (state.profile.isUnlocked) {
                                account.balance = container.querySelector('[name="balance"]').value;
                                account.cents = container.querySelector('[name="cents"]').value;
                            }
                            account.cuil = userData.cuil;
                            account.titular = userData.name;
                        });
                        userData.alias = accountsData[0].alias;


                        setTimeout(() => {
                            state.profile.isSaving = false;
                            const overlay = document.querySelector('.wait-modal-overlay');
                            if (overlay) overlay.remove();
                            handleNavigation('more');
                        }, 1500);
                    }
                }


                // --- INITIALIZATION ---
                document.addEventListener('DOMContentLoaded', () => {
                    render();
                    setupEventListeners();
                });
            
                    </script>
                </body>
                </html>
            